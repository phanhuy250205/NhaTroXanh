<!DOCTYPE html>
<html lang="vi">
<head th:replace="~{/layouts/head}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<head>
    <title>Chi Tiết Phòng Đang Thuê</title>
    <link rel="stylesheet" th:href="@{/css/chitiet-phongthue-guest.css}">
    <style>
        /* Rating Modal Styles */
        .rating-container {
            text-align: center;
            margin-bottom: 20px;
        }

        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 16px 0;
        }

        .star {
            font-size: 32px;
            color: #e5e7eb;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .star:hover,
        .star.active {
            color: #fbbf24;
            transform: scale(1.1);
        }

        .rating-text {
            font-size: 16px;
            font-weight: 600;
            color: #3e83cc;
            margin-top: 12px;
        }

        .rating-categories {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .rating-category {
            background: rgba(62, 131, 204, 0.05);
            border: 1px solid rgba(62, 131, 204, 0.1);
            border-radius: 12px;
            padding: 16px;
        }

        .category-title {
            font-size: 14px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .category-stars {
            display: flex;
            gap: 4px;
        }

        .category-stars .star {
            font-size: 20px;
        }

        @media (max-width: 992px) {
            .rating-categories {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }

        @media (max-width: 768px) {
            .rating-categories {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="detail-body-guest">
    <!-- NAVBAR -->
    <div th:replace="~{/layouts/navbar}"></div>

    <div class="main-container-guest">
        <!-- Breadcrumb -->
        <nav class="breadcrumb-guest">
            <a href="/khach-thue/quan-ly-thue-tra" style="text-decoration: none;">
                <i class="fas fa-arrow-left"></i>
                Quản lý thuê trả
            </a>
            <span class="mx-2">/</span>
            <span class="active">Chi tiết phòng A101</span>
        </nav>

        <div class="page-header-guest">
            <div>
                <h1 class="page-title-guest">Chi Tiết Phòng Đang Thuê</h1>
                <p class="page-subtitle-guest">Thông tin chi tiết và báo cáo sự cố của phòng A101 - Deluxe</p>
            </div>
        </div>

        <!-- Room Details Section -->
        <div class="section-card-guest">
            <h2 class="section-header-guest">
                <i class="fas fa-door-open"></i>
                Thông Tin Phòng
            </h2>
            
            <!-- Room Information -->
            <div class="room-info-section-guest">
                <div class="room-title-section-guest">
                    <div class="room-title-info-guest">
                        <h3 class="room-name-guest">Phòng A101 - Deluxe</h3>
                        <p class="room-type-guest">Phòng cao cấp với đầy đủ tiện nghi</p>
                        <div class="room-price-guest">1,200,000 VNĐ/tháng</div>
                    </div>
                    <div class="room-status-badge-guest">
                        <i class="fas fa-circle"></i>
                        Đang thuê
                    </div>
                </div>

                <div class="info-grid-guest">
                    <div class="info-item-guest">
                        <span class="info-label-guest">
                            <i class="fas fa-calendar-alt"></i>
                            Ngày thuê
                        </span>
                        <span class="info-value-guest">15/12/2024</span>
                    </div>
                    <div class="info-item-guest">
                        <span class="info-label-guest">
                            <i class="fas fa-calendar-check"></i>
                            Ngày hết hạn
                        </span>
                        <span class="info-value-guest">20/12/2024</span>
                    </div>
                    <div class="info-item-guest">
                        <span class="info-label-guest">
                            <i class="fas fa-users"></i>
                            Số khách
                        </span>
                        <span class="info-value-guest">2 người</span>
                    </div>
                    <div class="info-item-guest">
                        <span class="info-label-guest">
                            <i class="fas fa-expand-arrows-alt"></i>
                            Diện tích
                        </span>
                        <span class="info-value-guest">35 m²</span>
                    </div>
                </div>

                <!-- Amenities -->
                <div class="amenities-section-guest">
                    <h4 class="amenities-title-guest">
                        <i class="fas fa-star"></i>
                        Tiện nghi phòng
                    </h4>
                    <div class="amenities-grid-guest">
                        <div class="amenity-item-guest">
                            <span>WiFi miễn phí</span>
                        </div>
                        <div class="amenity-item-guest">
                            <span>Điều hòa</span>
                        </div>
                        <div class="amenity-item-guest">
                            <span>TV màn hình phẳng</span>
                        </div>
                        <div class="amenity-item-guest">
                            <span>Phòng tắm riêng</span>
                        </div>
                        <div class="amenity-item-guest">
                            <span>Minibar</span>
                        </div>
                        <div class="amenity-item-guest">
                            <span>Dịch vụ phòng 24/7</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="action-buttons-guest">
                <a href="/khach-thue/quan-ly-thue-tra">
                    <button class="action-btn-guest btn-back-guest" onclick="goBack()">
                        <i class="fas fa-arrow-left"></i>
                        Quay lại
                    </button>
                </a>
                
                <button class="action-btn-guest btn-extend-guest" onclick="openExtendModal()">
                    <i class="fas fa-calendar-plus"></i>
                    Gia hạn
                </button>
                <button class="action-btn-guest btn-return-guest" onclick="openReturnModal()">
                    <i class="fas fa-sign-out-alt"></i>
                    Trả phòng
                </button>
                <button class="action-btn-guest btn-report-guest" onclick="openReportModal()">
                    <i class="fas fa-exclamation-triangle"></i>
                    Báo cáo sự cố
                </button>
            </div>
        </div>

        <!-- Contract Information Section -->
        <div class="section-card-guest">
            <h2 class="section-header-guest">
                <i class="fas fa-file-contract"></i>
                Thông Tin Hợp Đồng
            </h2>
            
            <div class="contract-info-section-guest">
                <div class="contract-header-guest">
                    <div class="contract-title-info-guest">
                        <h3 class="contract-number-guest">Hợp đồng #HD2024001</h3>
                        <p class="contract-type-guest">Hợp đồng thuê phòng trọ</p>
                    </div>
                    <div class="contract-status-badge-guest contract-active-guest">
                        <i class="fas fa-check-circle"></i>
                        Đang hiệu lực
                    </div>
                </div>

                <!-- Compact Contract Details Grid -->
                <div class="contract-compact-grid-guest">
                    <div class="contract-compact-row-guest">
                        <div class="contract-compact-item-guest">
                            <span class="contract-compact-icon-guest">
                                <i class="fas fa-home"></i>
                            </span>
                            <div class="contract-compact-content-guest">
                                <span class="contract-compact-label-guest">Địa chỉ</span>
                                <span class="contract-compact-value-guest">Phòng 302, 123 Nguyễn Trãi, Quận 1, TP.HCM</span>
                            </div>
                        </div>
                        <div class="contract-compact-item-guest">
                            <span class="contract-compact-icon-guest">
                                <i class="fas fa-calendar-times"></i>
                            </span>
                            <div class="contract-compact-content-guest">
                                <span class="contract-compact-label-guest">Hết hạn</span>
                                <div class="contract-compact-expiry-guest">
                                    <span class="contract-compact-value-guest">2024-12-31</span>
                                    <span class="contract-days-remaining-guest">Còn -182 ngày</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contract-compact-row-guest">
                        <div class="contract-compact-item-guest">
                            <span class="contract-compact-icon-guest">
                                <i class="fas fa-user-tie"></i>
                            </span>
                            <div class="contract-compact-content-guest">
                                <span class="contract-compact-label-guest">Chủ nhà</span>
                                <span class="contract-compact-value-guest">Chị Nguyễn Thị Mai</span>
                            </div>
                        </div>
                        <div class="contract-compact-item-guest">
                            <span class="contract-compact-icon-guest">
                                <i class="fas fa-money-bill-wave"></i>
                            </span>
                            <div class="contract-compact-content-guest">
                                <span class="contract-compact-label-guest">Giá thuê</span>
                                <span class="contract-compact-price-guest">8.000.000 VNĐ/tháng</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contract Actions -->
                <div class="contract-actions-guest">
                    <button class="action-btn-guest btn-contract-view-guest" onclick="viewContractDetail()">
                        <i class="fas fa-eye"></i>
                        Xem hợp đồng đầy đủ
                    </button>
                    <button class="action-btn-guest btn-contract-download-guest" onclick="downloadContract()">
                        <i class="fas fa-download"></i>
                        Tải xuống PDF
                    </button>
                </div>
            </div>
        </div>

        <!-- Incident Reports Section -->
        <div class="table-section-guest">
            <div style="background: linear-gradient(135deg, #3e83cc 0%, #549eed 100%); color: white; padding: 16px 20px; font-size: 16px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; display: flex; align-items: center; gap: 8px;">
                <i class="fas fa-exclamation-circle"></i>
                Báo Cáo Sự Cố
            </div>
            
            <!-- Desktop Table -->
            <div class="table-container-guest">
                <table class="reports-table-guest">
                    <thead>
                        <tr>
                            <th>Mã BC</th>
                            <th>Tiêu đề</th>
                            <th>Mô tả</th>
                            <th>Mức độ</th>
                            <th>Ngày báo cáo</th>
                            <th>Trạng thái</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr onclick="viewReportDetail('BC001')">
                            <td style="font-weight: 600;">#BC001</td>
                            <td style="text-align: left; font-weight: 600;">Điều hòa không hoạt động</td>
                            <td style="text-align: left; max-width: 200px;">Điều hòa không thể bật, có thể do hỏng remote hoặc máy lạnh</td>
                            <td>
                                <span class="priority-badge-guest priority-high-guest">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Cao
                                </span>
                            </td>
                            <td>16/12/2024</td>
                            <td>
                                <span class="status-badge-guest status-pending-guest">
                                    <i class="fas fa-clock"></i>
                                    Chưa xử lý
                                </span>
                            </td>
                        </tr>
                        <tr onclick="viewReportDetail('BC002')">
                            <td style="font-weight: 600;">#BC002</td>
                            <td style="text-align: left; font-weight: 600;">Vòi nước bị rỉ</td>
                            <td style="text-align: left; max-width: 200px;">Vòi nước trong phòng tắm bị rỉ nhỏ giọt liên tục</td>
                            <td>
                                <span class="priority-badge-guest priority-medium-guest">
                                    <i class="fas fa-exclamation"></i>
                                    Trung bình
                                </span>
                            </td>
                            <td>15/12/2024</td>
                            <td>
                                <span class="status-badge-guest status-resolved-guest">
                                    <i class="fas fa-check-circle"></i>
                                    Đã giải quyết
                                </span>
                            </td>
                        </tr>
                        <tr onclick="viewReportDetail('BC003')">
                            <td style="font-weight: 600;">#BC003</td>
                            <td style="text-align: left; font-weight: 600;">Thiếu khăn tắm</td>
                            <td style="text-align: left; max-width: 200px;">Phòng chỉ có 1 khăn tắm, cần bổ sung thêm</td>
                            <td>
                                <span class="priority-badge-guest priority-low-guest">
                                    <i class="fas fa-info-circle"></i>
                                    Thấp
                                </span>
                            </td>
                            <td>15/12/2024</td>
                            <td>
                                <span class="status-badge-guest status-resolved-guest">
                                    <i class="fas fa-check-circle"></i>
                                    Đã giải quyết
                                </span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Mobile Cards -->
            <div class="mobile-cards-container-guest">
                <div class="report-card-mobile-guest" onclick="viewReportDetail('BC001')">
                    <div class="report-card-header-guest">
                        <div class="report-card-id-guest">#BC001</div>
                        <span class="priority-badge-guest priority-high-guest">
                            <i class="fas fa-exclamation-triangle"></i>
                            Cao
                        </span>
                    </div>
                    <div class="report-card-body-guest">
                        <div class="report-card-title-guest">Điều hòa không hoạt động</div>
                        <div class="report-card-description-guest">
                            Điều hòa không thể bật, có thể do hỏng remote hoặc máy lạnh
                        </div>
                        <div class="report-card-info-guest">
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Ngày báo cáo</div>
                                <div class="report-card-info-value-guest">16/12/2024</div>
                            </div>
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Trạng thái</div>
                                <div class="report-card-info-value-guest">
                                    <span class="status-badge-guest status-pending-guest">
                                        <i class="fas fa-clock"></i>
                                        Chưa xử lý
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="report-card-mobile-guest" onclick="viewReportDetail('BC002')">
                    <div class="report-card-header-guest">
                        <div class="report-card-id-guest">#BC002</div>
                        <span class="priority-badge-guest priority-medium-guest">
                            <i class="fas fa-exclamation"></i>
                            Trung bình
                        </span>
                    </div>
                    <div class="report-card-body-guest">
                        <div class="report-card-title-guest">Vòi nước bị rỉ</div>
                        <div class="report-card-description-guest">
                            Vòi nước trong phòng tắm bị rỉ nhỏ giọt liên tục
                        </div>
                        <div class="report-card-info-guest">
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Ngày báo cáo</div>
                                <div class="report-card-info-value-guest">15/12/2024</div>
                            </div>
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Trạng thái</div>
                                <div class="report-card-info-value-guest">
                                    <span class="status-badge-guest status-resolved-guest">
                                        <i class="fas fa-check-circle"></i>
                                        Đã giải quyết
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="report-card-mobile-guest" onclick="viewReportDetail('BC003')">
                    <div class="report-card-header-guest">
                        <div class="report-card-id-guest">#BC003</div>
                        <span class="priority-badge-guest priority-low-guest">
                            <i class="fas fa-info-circle"></i>
                            Thấp
                        </span>
                    </div>
                    <div class="report-card-body-guest">
                        <div class="report-card-title-guest">Thiếu khăn tắm</div>
                        <div class="report-card-description-guest">
                            Phòng chỉ có 1 khăn tắm, cần bổ sung thêm
                        </div>
                        <div class="report-card-info-guest">
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Ngày báo cáo</div>
                                <div class="report-card-info-value-guest">15/12/2024</div>
                            </div>
                            <div class="report-card-info-item-guest">
                                <div class="report-card-info-label-guest">Trạng thái</div>
                                <div class="report-card-info-value-guest">
                                    <span class="status-badge-guest status-resolved-guest">
                                        <i class="fas fa-check-circle"></i>
                                        Đã giải quyết
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contract Detail Modal -->
    <div class="modal-overlay-guest" id="contractDetailModal">
        <div class="modal-container-guest contract-modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest">
                    <i class="fas fa-file-contract"></i>
                    Hợp đồng thuê nhà trọ
                </h3>
                <button class="modal-close-guest" onclick="closeContractDetailModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest contract-modal-body-guest">
                <div class="contract-full-content-guest">
                    <!-- Contract Header -->
                    <div class="contract-detail-header-guest">
                        <div class="contract-id-badge-guest">
                            <i class="fas fa-file-alt"></i>
                            Mã hợp đồng: #CT001
                        </div>
                        <div class="contract-actions-header-guest">
                            <button class="contract-action-btn-guest" onclick="downloadContract()">
                                <i class="fas fa-download"></i>
                                Tải file hợp đồng
                            </button>
                            <button class="contract-action-btn-guest">
                                <i class="fas fa-print"></i>
                                In
                            </button>
                            <button class="contract-action-btn-guest">
                                <i class="fas fa-edit"></i>
                                Tạo về
                            </button>
                        </div>
                    </div>

                    <!-- General Information Section -->
                    <div class="contract-section-blue-guest">
                        <h4 class="contract-section-title-blue-guest">
                            <i class="fas fa-info-circle"></i>
                            Thông tin tổng quan
                        </h4>
                        <div class="contract-general-info-guest">
                            <div class="contract-date-item-guest">
                                <span class="contract-date-label-guest">Ngày ký hợp đồng</span>
                                <div class="contract-date-value-guest">
                                    <i class="fas fa-calendar"></i>
                                    2024-05-01
                                </div>
                            </div>
                            <div class="contract-date-item-guest">
                                <span class="contract-date-label-guest">Ngày hết hạn</span>
                                <div class="contract-date-value-guest">
                                    <i class="fas fa-calendar"></i>
                                    2024-12-31
                                </div>
                            </div>
                            <div class="contract-date-item-guest">
                                <span class="contract-date-label-guest">Thời hạn hợp đồng</span>
                                <div class="contract-duration-value-guest">
                                    12 tháng
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Property Information Section -->
                    <div class="contract-section-guest">
                        <h4 class="contract-section-title-guest">
                            <i class="fas fa-home"></i>
                            Thông tin phòng trọ
                        </h4>
                        <div class="contract-property-info-guest">
                            <div class="contract-property-row-guest">
                                <div class="contract-property-item-guest">
                                    <span class="contract-property-label-guest">Địa chỉ</span>
                                    <span class="contract-property-value-guest">Phòng 302, 123 Nguyễn Trãi, Quận 1, TP.HCM</span>
                                </div>
                                <div class="contract-property-item-guest">
                                    <span class="contract-property-label-guest">Diện tích</span>
                                    <span class="contract-property-value-guest">25m²</span>
                                </div>
                            </div>
                            <div class="contract-property-utilities-guest">
                                <span class="contract-property-label-guest">Tiện ích có sẵn phòng</span>
                                <div class="contract-utilities-list-guest">
                                    <span class="contract-utility-item-guest">Điện</span>
                                    <span class="contract-utility-item-guest">Nước</span>
                                    <span class="contract-utility-item-guest">Internet</span>
                                    <span class="contract-utility-item-guest">An ninh 24/7</span>
                                    <span class="contract-utility-item-guest">Bãi xe</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Terms Section -->
                    <div class="contract-section-guest">
                        <h4 class="contract-section-title-guest">
                            <i class="fas fa-dollar-sign"></i>
                            Điều khoản tài chính
                        </h4>
                        <div class="contract-financial-grid-guest">
                            <div class="contract-financial-card-guest contract-rental-card-guest">
                                <div class="contract-financial-label-guest">Tiền thuê hàng tháng</div>
                                <div class="contract-financial-amount-guest">8.000.000 VNĐ</div>
                                <div class="contract-financial-note-guest">Thanh toán vào ngày 1 hàng tháng</div>
                            </div>
                            <div class="contract-financial-card-guest contract-deposit-card-guest">
                                <div class="contract-financial-label-guest">Tiền cọc đặt cọc</div>
                                <div class="contract-financial-amount-guest">16.000.000 VNĐ</div>
                                <div class="contract-financial-note-guest">Hoàn trả khi kết thúc hợp đồng</div>
                            </div>
                        </div>
                    </div>

                    <!-- Parties Information -->
                    <div class="contract-parties-section-guest">
                        <div class="contract-party-card-guest">
                            <h4 class="contract-party-title-guest">
                                <i class="fas fa-user-tie"></i>
                                Thông tin chủ nhà (Bên cho thuê)
                            </h4>
                            <div class="contract-party-details-guest">
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Họ tên</span>
                                    <span class="contract-party-value-guest">Chị Nguyễn Thị Mai</span>
                                </div>
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Số điện thoại</span>
                                    <span class="contract-party-value-guest">
                                        <i class="fas fa-phone"></i>
                                        0901234567
                                    </span>
                                </div>
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Email</span>
                                    <span class="contract-party-value-guest">
                                        <i class="fas fa-envelope"></i>
                                        mai.nguyen@gmail.com
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="contract-party-card-guest">
                            <h4 class="contract-party-title-guest">
                                <i class="fas fa-user"></i>
                                Thông tin người thuê (Bên thuê)
                            </h4>
                            <div class="contract-party-details-guest">
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Họ tên</span>
                                    <span class="contract-party-value-guest">Anh Trần Văn Nam</span>
                                </div>
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Số điện thoại</span>
                                    <span class="contract-party-value-guest">
                                        <i class="fas fa-phone"></i>
                                        0987654321
                                    </span>
                                </div>
                                <div class="contract-party-field-guest">
                                    <span class="contract-party-label-guest">Email</span>
                                    <span class="contract-party-value-guest">
                                        <i class="fas fa-envelope"></i>
                                        nam.tran@gmail.com
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Terms and Conditions -->
                    <div class="contract-section-guest">
                        <h4 class="contract-section-title-guest">
                            <i class="fas fa-list-ul"></i>
                            Điều khoản và điều kiện
                        </h4>
                        <div class="contract-terms-list-guest">
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Bên thuê có trách nhiệm thanh toán tiền thuê đầy đủ và đúng hạn theo thỏa thuận, ngày 1 hàng tháng.</span>
                            </div>
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Nghiêm cấm việc cho thuê lại, chuyển nhượng quyền thuê của mình cho bên thứ ba mà không có sự đồng ý bằng văn bản của chủ nhà.</span>
                            </div>
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Bên thuê có trách nhiệm giữ gìn vệ sinh trong khu vực sử dụng, vệ sinh chung của tòa nhà.</span>
                            </div>
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Trong trường hợp muốn chấm dứt hợp đồng trước hạn, bên thuê phải báo trước ít nhất 30 ngày.</span>
                            </div>
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Tiền cọc sẽ được hoàn trả trong vòng 7 ngày kể từ khi bàn giao nhà và không có tranh chấp nào.</span>
                            </div>
                            <div class="contract-term-numbered-guest">
                                <span class="contract-term-number-guest">+</span>
                                <span class="contract-term-text-guest">Hai bên cam kết thực hiện đúng các điều khoản đã thỏa thuận và bàn giao phòng lại theo tình trạng ban đầu.</span>
                            </div>
                        </div>
                    </div>

                    <!-- Signature Section -->
                    <div class="contract-signature-section-guest">
                        <div class="contract-signature-card-guest">
                            <h5 class="contract-signature-title-guest">CHỮ KÝ BÊN CHO THUÊ</h5>
                            <div class="contract-signature-date-guest">Ngày ký: 2024-05-01</div>
                            <div class="contract-signature-name-guest">Chị Nguyễn Thị Mai</div>
                            <div class="contract-signature-area-guest">
                                <div class="contract-signature-placeholder-guest">
                                    (Chữ ký)
                                </div>
                            </div>
                        </div>

                        <div class="contract-signature-card-guest">
                            <h5 class="contract-signature-title-guest">CHỮ KÝ BÊN THUÊ</h5>
                            <div class="contract-signature-date-guest">Ngày ký: 2024-05-01</div>
                            <div class="contract-signature-name-guest">Anh Trần Văn Nam</div>
                            <div class="contract-signature-area-guest">
                                <div class="contract-signature-placeholder-guest">
                                    (Chữ ký)
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer Note -->
                    <div class="contract-footer-note-guest">
                        <p>Hợp đồng này được lập thành 02 bản có giá trị pháp lý như nhau, mỗi bên giữ 01 bản.</p>
                        <p>Ngày lập: 01/05/2024</p>
                    </div>
                </div>
            </div>

            <div class="modal-footer-guest">
                <button class="modal-btn-guest modal-btn-secondary-guest" onclick="closeContractDetailModal()">
                    <i class="fas fa-times"></i>
                    Đóng
                </button>
                <button class="modal-btn-guest modal-btn-primary-guest" onclick="downloadContract()">
                    <i class="fas fa-download"></i>
                    Tải xuống PDF
                </button>
            </div>
        </div>
    </div>

    <!-- Report Detail Modal -->
    <div class="modal-overlay-guest" id="reportDetailModal">
        <div class="modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest" id="reportDetailTitle">
                    <i class="fas fa-info-circle"></i>
                    Chi tiết báo cáo
                </h3>
                <button class="modal-close-guest" onclick="closeReportDetailModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest" id="reportDetailContent">
                <!-- Content will be populated by JavaScript -->
            </div>

            <div class="modal-footer-guest" id="reportDetailFooter">
                <!-- Footer will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Create/Edit Report Modal -->
    <div class="modal-overlay-guest" id="reportModal">
        <div class="modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest" id="reportModalTitle">
                    <i class="fas fa-exclamation-triangle"></i>
                    Báo Cáo Sự Cố
                </h3>
                <button class="modal-close-guest" onclick="closeReportModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest">
                <form id="reportForm">
                    <input type="hidden" id="reportId" value="">
                    <div class="form-group-guest">
                        <label class="form-label-guest" for="reportTitle">
                            <i class="fas fa-heading"></i>
                            Tiêu đề sự cố
                        </label>
                        <input 
                            type="text" 
                            id="reportTitle" 
                            class="form-input-guest" 
                            placeholder="Nhập tiêu đề ngắn gọn về sự cố..."
                            required
                        >
                    </div>

                    <div class="form-group-guest">
                        <label class="form-label-guest" for="reportPriority">
                            <i class="fas fa-flag"></i>
                            Mức độ ưu tiên
                        </label>
                        <select id="reportPriority" class="form-select-guest" required>
                            <option value="">Chọn mức độ ưu tiên</option>
                            <option value="low">Thấp - Không ảnh hưởng nhiều</option>
                            <option value="medium">Trung bình - Cần xử lý sớm</option>
                            <option value="high">Cao - Cần xử lý ngay</option>
                        </select>
                    </div>

                    <div class="form-group-guest">
                        <label class="form-label-guest" for="reportDescription">
                            <i class="fas fa-comment-alt"></i>
                            Mô tả chi tiết
                        </label>
                        <textarea 
                            id="reportDescription" 
                            class="form-input-guest form-textarea-guest" 
                            placeholder="Mô tả chi tiết về sự cố, vị trí, thời gian xảy ra..."
                            rows="4"
                            required
                        ></textarea>
                    </div>

                    <!-- Image Upload Section -->
                    <div class="image-upload-section-guest">
                        <div class="image-upload-title-guest">
                            <i class="fas fa-images"></i>
                            Hình ảnh minh họa (tùy chọn)
                        </div>
                        <div class="image-upload-area-guest" id="imageUploadArea">
                            <input 
                                type="file" 
                                id="imageInput" 
                                class="image-upload-input-guest" 
                                accept="image/*" 
                                multiple
                                style="display: none;"
                            >
                            <div class="image-upload-icon-guest">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            <div class="image-upload-text-guest">
                                Nhấp để chọn ảnh hoặc kéo thả ảnh vào đây
                            </div>
                            <div class="image-upload-hint-guest">
                                Hỗ trợ: JPG, PNG, GIF (tối đa 5MB mỗi ảnh)
                            </div>
                        </div>
                        <div class="image-preview-container-guest" id="imagePreviewContainer">
                            <!-- Image previews will be added here -->
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer-guest">
                <button class="modal-btn-guest modal-btn-secondary-guest" onclick="closeReportModal()">
                    <i class="fas fa-times"></i>
                    Hủy bỏ
                </button>
                <button class="modal-btn-guest modal-btn-primary-guest" onclick="submitReport()">
                    <i class="fas fa-paper-plane"></i>
                    <span id="reportSubmitText">Gửi báo cáo</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Extend Rental Modal -->
    <div class="modal-overlay-guest" id="extendModal">
        <div class="modal-container-guest extend-modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest">
                    <i class="fas fa-calendar-plus"></i>
                    Yêu Cầu Gia Hạn
                </h3>
                <button class="modal-close-guest" onclick="closeExtendModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest extend-modal-body-guest">
                <!-- Current Contract Info -->
                <div class="current-contract-info-guest">
                    <h4 class="current-contract-title-guest">
                        <i class="fas fa-home"></i>
                        Thông tin hợp đồng hiện tại
                    </h4>
                    
                    <div class="contract-info-grid-guest">
                        <div class="contract-info-row-guest">
                            <div class="contract-info-item-guest">
                                <span class="contract-info-label-guest">Địa chỉ nhà trọ</span>
                                <span class="contract-info-value-guest">
                                    <i class="fas fa-map-marker-alt"></i>
                                    Phòng A101, 123 Nguyễn Trãi, Quận 1, TP.HCM
                                </span>
                            </div>
                            <div class="contract-info-item-guest">
                                <span class="contract-info-label-guest">Chủ nhà</span>
                                <span class="contract-info-value-guest">Nguyễn Văn A</span>
                            </div>
                        </div>
                        
                        <div class="contract-info-row-guest">
                            <div class="contract-info-item-guest">
                                <span class="contract-info-label-guest">Ngày hết hạn</span>
                                <span class="contract-info-value-guest">
                                    <i class="fas fa-calendar"></i>
                                    20/12/2024
                                </span>
                            </div>
                            <div class="contract-info-item-guest">
                                <span class="contract-info-label-guest">Giá thuê hiện tại</span>
                                <span class="contract-info-value-guest contract-price-guest">1,200,000 VNĐ/tháng</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contract-status-warning-guest">
                        <i class="fas fa-exclamation-triangle"></i>
                        Sắp hết hạn
                    </div>
                </div>

                <!-- Extension Request Form -->
                <form id="extendForm">
                    <div class="extension-request-section-guest">
                        <h4 class="extension-request-title-guest">
                            <i class="fas fa-clock"></i>
                            Yêu cầu gia hạn
                        </h4>
                        
                        <div class="form-group-guest">
                            <label class="form-label-guest extend-label-guest" for="extendPeriod">
                                Thời gian gia hạn mong muốn <span class="required-star-guest">*</span>
                            </label>
                            <select id="extendPeriod" class="form-select-guest extend-select-guest" required onchange="handleExtendPeriodChange()">
                                <option value="">Chọn thời gian gia hạn</option>
                                <option value="1">1 tháng</option>
                                <option value="6">6 tháng</option>
                                <option value="12">1 năm</option>
                                <option value="24">2 năm</option>
                                <option value="custom">Tùy chỉnh</option>
                            </select>
                            
                            <!-- Custom date input - hidden by default -->
                            <div id="customDateContainer" class="custom-date-container-guest" style="display: none;">
                                <label class="form-label-guest extend-label-guest" for="customExtendDate">
                                    Chọn ngày hết hạn mới
                                </label>
                                <input 
                                    type="date" 
                                    id="customExtendDate" 
                                    class="form-input-guest" 
                                    onchange="updateNewExpiryDate()"
                                >
                            </div>
                        </div>

                        <!-- New expiry date display -->
                        <div id="newExpiryDisplay" class="new-expiry-display-guest" style="display: none;">
                            <div class="new-expiry-content-guest">
                                <span class="new-expiry-label-guest">Ngày kết thúc mới:</span>
                                <span id="newExpiryDate" class="new-expiry-date-guest"></span>
                            </div>
                        </div>

                        <div class="form-group-guest">
                            <label class="form-label-guest extend-label-guest" for="extendMessage">
                                Lời nhắn gửi chủ nhà
                            </label>
                            <textarea
                                id="extendMessage"
                                class="form-textarea-guest extend-textarea-guest"
                                placeholder="Chia sẻ lý do bạn muốn gia hạn hợp đồng, cam kết của bạn, hoặc những điều bạn yêu thích ở nơi này..."
                                rows="4"
                            ></textarea>
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer-guest">
                <button class="modal-btn-guest modal-btn-secondary-guest" onclick="closeExtendModal()">
                    <i class="fas fa-times"></i>
                    Hủy bỏ
                </button>
                <button class="modal-btn-guest modal-btn-primary-guest" onclick="submitExtend()">
                    <i class="fas fa-paper-plane"></i>
                    Gửi yêu cầu gia hạn
                </button>
            </div>
        </div>
    </div>

    <!-- Return Room Modal -->
    <div class="modal-overlay-guest" id="returnModal">
        <div class="modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest">
                    <i class="fas fa-sign-out-alt"></i>
                    Trả Phòng
                </h3>
                <button class="modal-close-guest" onclick="closeReturnModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest">
                <form id="returnForm">
                    <div class="form-group-guest">
                        <label class="form-label-guest" for="returnDate">
                            <i class="fas fa-calendar-alt"></i>
                            Ngày trả phòng
                        </label>
                        <input
                            type="date"
                            id="returnDate"
                            class="form-input-guest"
                            required
                        >
                    </div>

                    <div class="form-group-guest">
                        <label class="form-label-guest" for="returnReason">
                            <i class="fas fa-comment-alt"></i>
                            Lý do trả phòng
                        </label>
                        <textarea
                            id="returnReason"
                            class="form-input-guest form-textarea-guest"
                            placeholder="Nhập lý do trả phòng (tùy chọn)..."
                            rows="4"
                        ></textarea>
                    </div>
                </form>
            </div>

            <div class="modal-footer-guest">
                <button class="modal-btn-guest modal-btn-secondary-guest" onclick="closeReturnModal()">
                    <i class="fas fa-times"></i>
                    Hủy bỏ
                </button>
                <button class="modal-btn-guest modal-btn-primary-guest" onclick="submitReturn()">
                    <i class="fas fa-check"></i>
                    Xác nhận trả phòng
                </button>
            </div>
        </div>
    </div>

    <!-- Rating Modal -->
    <div class="modal-overlay-guest" id="ratingModal">
        <div class="modal-container-guest">
            <div class="modal-header-guest">
                <h3 class="modal-title-guest">
                    <i class="fas fa-star"></i>
                    Đánh Giá Phòng
                </h3>
                <button class="modal-close-guest" onclick="closeRatingModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body-guest">
                <!-- Room Information -->
                <div class="room-info-modal">
                    <h4>
                        <i class="fas fa-door-open"></i>
                        Phòng vừa trả: A101 - Deluxe
                    </h4>
                </div>

                <!-- Overall Rating -->
                <div class="rating-container">
                    <h4 style="color: #3e83cc; margin-bottom: 16px;">Đánh giá tổng thể</h4>
                    <div class="rating-stars" id="overallRating">
                        <span class="star" data-rating="1">★</span>
                        <span class="star" data-rating="2">★</span>
                        <span class="star" data-rating="3">★</span>
                        <span class="star" data-rating="4">★</span>
                        <span class="star" data-rating="5">★</span>
                    </div>
                    <div class="rating-text" id="overallRatingText">Chọn số sao để đánh giá</div>
                </div>

                <!-- Category Ratings -->
                <div class="rating-categories">
                    <div class="rating-category">
                        <div class="category-title">
                            <i class="fas fa-broom"></i>
                            Vệ sinh phòng
                        </div>
                        <div class="category-stars" data-category="cleanliness">
                            <span class="star" data-rating="1">★</span>
                            <span class="star" data-rating="2">★</span>
                            <span class="star" data-rating="3">★</span>
                            <span class="star" data-rating="4">★</span>
                            <span class="star" data-rating="5">★</span>
                        </div>
                    </div>

                    <div class="rating-category">
                        <div class="category-title">
                            <i class="fas fa-concierge-bell"></i>
                            Dịch vụ
                        </div>
                        <div class="category-stars" data-category="service">
                            <span class="star" data-rating="1">★</span>
                            <span class="star" data-rating="2">★</span>
                            <span class="star" data-rating="3">★</span>
                            <span class="star" data-rating="4">★</span>
                            <span class="star" data-rating="5">★</span>
                        </div>
                    </div>

                    <div class="rating-category">
                        <div class="category-title">
                            <i class="fas fa-bed"></i>
                            Tiện nghi
                        </div>
                        <div class="category-stars" data-category="amenities">
                            <span class="star" data-rating="1">★</span>
                            <span class="star" data-rating="2">★</span>
                            <span class="star" data-rating="3">★</span>
                            <span class="star" data-rating="4">★</span>
                            <span class="star" data-rating="5">★</span>
                        </div>
                    </div>

                    <div class="rating-category">
                        <div class="category-title">
                            <i class="fas fa-dollar-sign"></i>
                            Giá cả
                        </div>
                        <div class="category-stars" data-category="price">
                            <span class="star" data-rating="1">★</span>
                            <span class="star" data-rating="2">★</span>
                            <span class="star" data-rating="3">★</span>
                            <span class="star" data-rating="4">★</span>
                            <span class="star" data-rating="5">★</span>
                        </div>
                    </div>
                </div>

                <!-- Comment -->
                <div class="form-group-guest">
                    <label class="form-label-guest" for="ratingComment">
                        <i class="fas fa-comment"></i>
                        Nhận xét (tùy chọn)
                    </label>
                    <textarea 
                        id="ratingComment" 
                        class="form-input-guest form-textarea-guest" 
                        placeholder="Chia sẻ trải nghiệm của bạn về phòng này..."
                        rows="4"
                    ></textarea>
                </div>
            </div>

            <div class="modal-footer-guest">
                <button class="modal-btn-guest modal-btn-secondary-guest" onclick="skipRating()">
                    <i class="fas fa-skip-forward"></i>
                    Bỏ qua
                </button>
                <button class="modal-btn-guest modal-btn-primary-guest" onclick="submitRating()">
                    <i class="fas fa-paper-plane"></i>
                    Gửi đánh giá
                </button>
            </div>
        </div>
    </div>

    <!-- Include the external JavaScript file -->
    <script th:src="@{/js/chitiet-phongthue-guest.js}"></script>
</body>
</html>
