<!DOCTYPE html>
<html lang="en">
<head th:replace="~{/layouts/head}">
    <title>Nhà Trọ Xanh</title>
</head>
<body class="phongtro">
    <div th:replace="~{/layouts/sidebar-host}"></div>

    <div class="main-content-host" id="mainContentHost">
        <div class="content-container-host">
            <div class="page-header-host">
                <h1 class="page-title-host">QUẢN LÝ PHÒNG TRỌ</h1>
            </div>

            <div th:if="${error}" class="alert alert-danger" role="alert">
                <span th:text="${error}"></span>
            </div>

            <div th:if="${success}" class="alert alert-success" role="alert">
                <span th:text="${success}"></span>
            </div>

            <div class="tabs-container-host">
                <ul class="nav nav-tabs tabs-nav-host" id="roomTabsHost" role="tablist">
                    <li class="nav-item tab-item-host" role="presentation">
                        <button class="nav-link tab-link-host active" id="room-list-tab-host" data-bs-toggle="tab"
                            data-bs-target="#room-list-host" type="button" role="tab" aria-controls="room-list-host"
                            aria-selected="true">
                            <i class="fas fa-list me-2"></i>
                            Danh sách phòng trọ
                        </button>
                    </li>
                    <li class="nav-item tab-item-host" role="presentation">
                        <button class="nav-link tab-link-host" id="add-room-tab-host" data-bs-toggle="tab"
                            data-bs-target="#add-room-host" type="button" role="tab" aria-controls="add-room-host"
                            aria-selected="false">
                            <i class="fas fa-plus me-2"></i>
                            <span id="addRoomTabText">Thêm phòng mới</span>
                        </button>
                    </li>
                    <li class="nav-item tab-item-host" role="presentation">
                        <button class="nav-link tab-link-host" id="status-management-tab-host" data-bs-toggle="tab"
                            data-bs-target="#status-management-host" type="button" role="tab"
                            aria-controls="status-management-host" aria-selected="false">
                            <i class="fas fa-cogs me-2"></i>
                            Quản lý trạng thái
                        </button>
                    </li>
                </ul>
            </div>

            <div class="tab-content tabs-content-host" id="roomTabContentHost">
                <div class="tab-pane fade show active" id="room-list-host" role="tabpanel"
                    aria-labelledby="room-list-tab-host" tabindex="0">
                    <div class="hostel-selection-section">
                        <div class="row g-3">
                            <div class="col-md-12">
                                <div class="form-group-modern">
                                    <label for="hostelSelect" class="form-label-modern">Chọn khu trọ</label>
                                    <select class="form-select-modern" id="hostelSelect" onchange="window.location.href='/chu-tro/quan-ly-tro?hostelId=' + this.value">
                                        <option value="">Chọn khu trọ</option>
                                        <option th:each="hostel : ${hostels}" th:value="${hostel.hostelId}" th:text="${hostel.name}" th:selected="${hostel.hostelId == hostelId}"></option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="search-filter-section-host">
                        <div class="row g-3">
                            <div class="col-md-8">
                                <div class="search-container-host">
                                    <input type="text" class="form-control search-input-host"
                                        placeholder="Tìm kiếm phòng..." id="searchRoomInputHost">
                                    <button class="btn search-btn-host" type="button">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <select class="form-select status-filter-host" id="statusFilterHost">
                                    <option value="">Tất cả trạng thái</option>
                                    <option value="unactive">Trống</option>
                                    <option value="active">Đã thuê</option>
                                    <option value="repair">Bảo trì</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="table-container-host">
                        <div class="table-responsive">
                            <table class="table room-table-host" id="roomTableHost">
                                <thead class="table-header-host">
                                    <tr>
                                        <th class="table-th-host-name">Tên phòng</th>
                                        <th class="table-th-host-price">Giá thuê</th>
                                        <th class="table-th-host">Trạng thái</th>
                                        <th class="table-th-host">Diện tích</th>
                                        <th class="table-th-host">Số người tối đa</th>
                                        <th class="table-th-host">Thao tác</th>
                                    </tr>
                                </thead>
                                <tbody class="table-body-host" id="roomTableBodyHost">
                                    <tr class="table-row-host" th:each="room : ${rooms}">
                                        <td class="table-td-host room-name-host" th:text="${room.namerooms}"></td>
                                        <td class="table-td-host-price price-host" th:text="${#numbers.formatDecimal(room.price, 0, 'COMMA', 0, 'POINT')} + ' ₫'"></td>
                                        <td class="table-td-host">
                                            <span th:class="'status-badge-host ' + (${room.status.name()} == 'unactive' ? 'status-available-host' : (${room.status.name()} == 'active' ? 'status-occupied-host' : 'status-maintenance-host'))"
                                                th:text="${room.status.name()} == 'unactive' ? 'Trống' : (${room.status.name()} == 'active' ? 'Đã thuê' : 'Bảo trì')">
                                            </span>
                                        </td>
                                        <td class="table-td-host" th:text="${room.acreage} + ' m²'"></td>
                                        <td class="table-td-host" th:text="${room.max_tenants} + ' người'"></td>
                                        <td class="table-td-host">
                                            <div class="action-buttons-host">
                                                <button class="btn-edit-host" title="Chỉnh sửa" data-bs-toggle="tab"
                                                    data-bs-target="#add-room-host" role="tab"
                                                    aria-controls="add-room-host" th:attr="data-room-id=${room.roomId}">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                <form th:action="@{/chu-tro/xoa-phong/{roomId}(roomId=${room.roomId})}" method="post" style="display:inline;">
                                                    <input type="hidden" name="hostelId" th:value="${hostelId}">
                                                    <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Bạn có chắc muốn xóa phòng này?')">
                                                        <i class="fas fa-trash"></i> Xóa
                                                    </button>
                                                </form>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="tab-pane fade" id="add-room-host" role="tabpanel" aria-labelledby="add-room-tab-host" tabindex="0">
                    <div class="add-room-container-modern">
                        <form id="addRoomFormHost" class="add-room-form-modern" th:action="@{/chu-tro/them-phong}" method="post">
                            <input type="hidden" id="roomIdHost" name="roomId">
                            <div class="form-row-modern">
                                <div class="form-group-modern">
                                    <label for="roomAreaSelectHost" class="form-label-modern">
                                        Khu trọ <span class="required-star">*</span>
                                    </label>
                                    <select class="form-select-modern" id="roomAreaSelectHost" name="hostelId" required>
                                        <option value="">Chọn khu trọ</option>
                                        <option th:each="hostel : ${hostels}" th:value="${hostel.hostelId}" th:text="${hostel.name}"></option>
                                    </select>
                                </div>
                                <div class="form-group-modern">
                                    <label for="roomNameHost" class="form-label-modern">
                                        Tên phòng <span class="required-star">*</span>
                                    </label>
                                    <input type="text" class="form-input-modern" id="roomNameHost" name="namerooms"
                                        placeholder="Nhập tên phòng (VD: A101)" required>
                                </div>
                            </div>
                            <div class="form-row-modern">
                                <div class="form-group-modern">
                                    <label for="roomPriceHost" class="form-label-modern">
                                        Giá thuê (VNĐ) <span class="required-star">*</span>
                                    </label>
                                    <input type="text" class="form-input-modern" id="roomPriceHost" name="price"
                                        placeholder="Nhập giá thuê phòng" required>
                                </div>
                                <div class="form-group-modern">
                                    <label for="roomStatusHost" class="form-label-modern">
                                        Trạng thái <span class="required-star">*</span>
                                    </label>
                                    <select class="form-select-modern" id="roomStatusHost" name="status" required>
                                        <option value="unactive">Trống</option>
                                        <option value="active">Đã thuê</option>
                                        <option value="repair">Bảo trì</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row-modern">
                                <div class="form-group-modern">
                                    <label for="roomAreaHost" class="form-label-modern">
                                        Diện tích (m²) <span class="required-star">*</span>
                                    </label>
                                    <input type="text" class="form-input-modern" id="roomAreaHost" name="acreage"
                                        placeholder="Nhập diện tích phòng" required>
                                </div>
                                <div class="form-group-modern">
                                    <label for="roomCapacityHost" class="form-label-modern">
                                        Số người tối đa <span class="required-star">*</span>
                                    </label>
                                    <input type="text" class="form-input-modern" id="roomCapacityHost" name="maxTenants"
                                        placeholder="Số người thuê phòng tối đa" required>
                                </div>
                            </div>
                            <div class="form-group-modern full-width">
                                <label class="form-label-modern">Tiện ích phòng</label>
                                <div class="amenities-grid" th:unless="${utilities == null or #lists.isEmpty(utilities)}">
                                    <div class="amenity-item" th:each="utility : ${utilities}">
                                    <input type="checkbox" th:id="'utility-' + ${utility.utilityId}" name="amenities"
                                        th:value="${utility.name}" class="amenity-checkbox">
                                    <label th:for="'utility-' + ${utility.utilityId}" class="amenity-label">
                                        <i th:switch="${utility.name}">
                                            <i th:case="'WiFi'" class="fas fa-wifi"></i>
                                            <i th:case="'Điều hòa'" class="fas fa-snowflake"></i>
                                            <i th:case="'Tủ lạnh'" class="fas fa-cube"></i>
                                            <i th:case="'Máy giặt'" class="fas fa-tshirt"></i>
                                            <i th:case="'Nước nóng'" class="fas fa-fire"></i>
                                            <i th:case="'Bếp riêng'" class="fas fa-utensils"></i>
                                            <i th:case="'WC riêng'" class="fas fa-bath"></i>
                                            <i th:case="*" class="fas fa-circle"></i> <!-- Default case -->
                                        </i>
                                        <span th:text="${utility.name}"></span>
                                    </label>
                                </div>
                                </div>
                                <div th:if="${utilities == null or #lists.isEmpty(utilities)}" class="alert alert-warning">
                                    Không có tiện ích nào để hiển thị. Vui lòng thêm tiện ích trong hệ thống.
                                </div>
                            </div>
                            <div class="form-group-modern full-width">
                                <label for="roomDescriptionHost" class="form-label-modern">Mô tả chi tiết</label>
                                <textarea class="form-textarea-modern" id="roomDescriptionHost" name="description"
                                    placeholder="Mô tả chi tiết về phòng, vị trí, môi trường xung quanh..." rows="4"></textarea>
                            </div>
                            <div class="image-upload-section">
                                <div class="upload-area" id="uploadArea">
                                    <div class="upload-icon">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.89 22 5.99 22H18C19.1 22 20 21.1 20 20V8L14 2Z"
                                                stroke="#3E83CC" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                            <path d="M14 2V8H20" stroke="#3E83CC" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round" />
                                            <path d="M16 13L12 9L8 13" stroke="#3E83CC" stroke-width="2"
                                                stroke-linecap="round" stroke-linejoin="round" />
                                            <path d="M12 9V19" stroke="#3E83CC" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                    </div>
                                    <p class="upload-text">Kéo thả ảnh vào đây hoặc click để chọn</p>
                                    <input type="file" id="imageUpload" multiple accept="image/*"
                                        style="display: none;">
                                </div>
                                <div class="image-preview-container" id="imagePreviewContainer"></div>
                            </div>
                            <div class="form-actions-modern">
                                <button type="button" class="btn-cancel-modern" onclick="resetForm()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path d="M18 6L6 18M6 6L18 18" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    Hủy bỏ
                                </button>
                                <button type="submit" class="btn-submit-modern" id="submitRoomBtn">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <span id="submitBtnText">Thêm phòng</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="tab-pane fade" id="status-management-host" role="tabpanel"
                    aria-labelledby="status-management-tab-host" tabindex="0">
                    <div class="status-management-modern">
                        <div class="stats-grid-modern">
                            <div class="stat-card-modern stat-total-modern">
                                <div class="stat-icon-modern">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                        <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div class="stat-content-modern">
                                    <div class="stat-label-modern">Tổng phòng</div>
                                    <div class="stat-number-modern" id="totalRoomsCount">0</div>
                                    <div class="stat-sublabel-modern">phòng</div>
                                    <div class="stat-action-modern">Xem danh sách</div>
                                </div>
                            </div>
                            <div class="stat-card-modern stat-available-modern">
                                <div class="stat-icon-modern">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path d="M3 21H21M5 21V7L13 2L21 7V21M9 9H15M9 13H15M9 17H15"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div class="stat-content-modern">
                                    <div class="stat-label-modern">Phòng trống</div>
                                    <div class="stat-number-modern" id="availableRoomsCount">0</div>
                                    <div class="stat-sublabel-modern">phòng</div>
                                    <div class="stat-action-modern">Xem danh sách</div>
                                </div>
                            </div>
                            <div class="stat-card-modern stat-occupied-modern">
                                <div class="stat-icon-modern">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M2 4V20C2 20.5304 2.21071 21.0391 2.58579 21.4142C2.96086 21.7893 3.46957 22 4 22H20C20.5304 22 21.0391 21.7893 21.4142 21.4142C21.7893 21.0391 22 20.5304 22 20V4C22 3.46957 21.7893 2.96086 21.4142 2.58579C21.0391 2.21071 20.5304 2 20 2H4C3.46957 2 2.96086 2.21071 2.58579 2.58579C2.21071 2.96086 2 3.46957 2 4Z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                        <path
                                            d="M7 22V18C7 17.4696 7.21071 16.9609 7.58579 16.5858C7.96086 16.2107 8.46957 16 9 16H15C15.5304 16 16.0391 16.2107 16.4142 16.5858C16.7893 16.9609 17 17.4696 17 18V22"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div class="stat-content-modern">
                                    <div class="stat-label-modern">Phòng đã thuê</div>
                                    <div class="stat-number-modern" id="occupiedRoomsCount">0</div>
                                    <div class="stat-sublabel-modern">phòng</div>
                                    <div class="stat-action-modern">Xem danh sách</div>
                                </div>
                            </div>
                            <div class="stat-card-modern stat-maintenance-modern">
                                <div class="stat-icon-modern">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M14.7 6.3C15.1 5.9 15.1 5.3 14.7 4.9L13.1 3.3C12.7 2.9 12.1 2.9 11.7 3.3L10.3 4.7L15.3 9.7L14.7 6.3Z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                        <path d="M9 5L4 1.5L5.5 3L4 4.5L9 5Z" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <path d="M9 5L15.3 9.7L10.3 4.7L9 5Z" stroke="currentColor" stroke-width="2"
                                            stroke-linecap="round" stroke-linejoin="round" />
                                        <path
                                            d="M15.3 9.7L20.5 14.9C20.9 15.3 20.9 15.9 20.5 16.3L18.9 17.9C18.5 18.3 17.9 18.3 17.5 17.9L12.3 12.7L15.3 9.7Z"
                                            stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                            stroke-linejoin="round" />
                                    </svg>
                                </div>
                                <div class="stat-content-modern">
                                    <div class="stat-label-modern">Phòng bảo trì</div>
                                    <div class="stat-number-modern" id="maintenanceRoomsCount">0</div>
                                    <div class="stat-sublabel-modern">phòng</div>
                                    <div class="stat-action-modern">Xem danh sách</div>
                                </div>
                            </div>
                        </div>
                        <div class="chart-section-modern">
                            <div class="chart-container-modern">
                                <h3 class="chart-title-modern">Biểu đồ thống kê tỷ lệ tình trạng phòng</h3>
                                <div class="chart-wrapper-modern">
                                    <div class="chart-canvas-container">
                                        <canvas id="roomStatusChart" width="400" height="400"></canvas>
                                    </div>
                                    <div class="chart-legend-modern">
                                        <div class="legend-item-modern">
                                            <div class="legend-color-modern legend-available"></div>
                                            <span class="legend-text-modern">Phòng trống</span>
                                        </div>
                                        <div class="legend-item-modern">
                                            <div class="legend-color-modern legend-occupied"></div>
                                            <span class="legend-text-modern">Phòng đã thuê</span>
                                        </div>
                                        <div class="legend-item-modern">
                                            <div class="legend-color-modern legend-maintenance"></div>
                                            <span class="legend-text-modern">Phòng bảo trì</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="quick-actions-modern">
                            <div class="action-card-modern">
                                <h4 class="action-title-modern">Thay đổi trạng thái nhanh</h4>
                                <div class="action-form-modern">
                                    <div class="form-group-inline-modern">
                                        <label for="quickHostelSelect" class="form-label-modern">Chọn khu trọ:</label>
                                        <select class="form-select-modern" id="quickHostelSelect">
                                            <option value="">Chọn khu trọ...</option>
                                            <option th:each="hostel : ${hostels}" th:value="${hostel.hostelId}" th:text="${hostel.name}"></option>
                                        </select>
                                    </div>
                                    <div class="form-group-inline-modern">
                                        <label for="quickRoomSelect" class="form-label-modern">Chọn phòng:</label>
                                        <select class="form-select-modern" id="quickRoomSelect">
                                            <option value="">Chọn phòng...</option>
                                            <option th:each="room : ${rooms}" th:value="${room.roomId}" th:text="${room.namerooms}"></option>
                                        </select>
                                    </div>
                                    <div class="form-group-inline-modern">
                                        <label for="quickStatusSelect" class="form-label-modern">Trạng thái mới:</label>
                                        <select class="form-select-modern" id="quickStatusSelect">
                                            <option value="">Chọn trạng thái...</option>
                                            <option value="unactive">Trống</option>
                                            <option value="active">Đã thuê</option>
                                            <option value="repair">Bảo trì</option>
                                        </select>
                                    </div>
                                    <button type="button" class="btn-update-status-modern" id="updateStatusBtn">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none"
                                            xmlns="http://www.w3.org/2000/svg">
                                            <path
                                                d="M1 4V10H7M23 20V14H17M20.49 9C19.9828 7.56678 19.1209 6.28392 17.9845 5.27304C16.8482 4.26216 15.4745 3.55682 13.9917 3.21834C12.5089 2.87986 10.9652 2.91902 9.50481 3.33329C8.04437 3.74757 6.71475 4.52306 5.64 5.58L1 10M23 14L18.36 18.42C17.2853 19.477 15.9556 20.2524 14.4952 20.6667C13.0348 21.081 11.4911 21.1201 10.0083 20.7817C8.52547 20.4432 7.1518 19.7378 6.01547 18.727C4.87913 17.7161 4.01717 16.4332 3.51 15"
                                                stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                                stroke-linejoin="round" />
                                        </svg>
                                        Cập nhật
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function resetForm() {
            const form = document.getElementById("addRoomFormHost");
            form.reset();
            form.action = "/chu-tro/them-phong";
            document.getElementById("submitBtnText").textContent = "Thêm phòng";
            document.getElementById("addRoomTabText").textContent = "Thêm phòng mới";
            document.getElementById("roomIdHost").value = "";
            window.imageUploader.clearAll();
            RoomManagementUI.showNotification("Đã đặt lại form", "info");
        }

        document.getElementById("addRoomFormHost").addEventListener("submit", function (e) {
            e.preventDefault();
            const formData = new FormData();
            formData.append("roomId", document.getElementById("roomIdHost").value);
            formData.append("namerooms", document.getElementById("roomNameHost").value);
            formData.append("price", document.getElementById("roomPriceHost").value.replace(/[^\d]/g, ''));
            formData.append("acreage", document.getElementById("roomAreaHost").value);
            formData.append("status", document.getElementById("roomStatusHost").value);
            formData.append("maxTenants", document.getElementById("roomCapacityHost").value);
            formData.append("hostelId", document.getElementById("roomAreaSelectHost").value);
            formData.append("description", document.getElementById("roomDescriptionHost").value);

            const amenities = [];
            document.querySelectorAll("input[name='amenities']:checked").forEach(item => {
                amenities.push(item.value);
            });
            amenities.forEach(item => formData.append("amenities", item));

            const actionUrl = formData.get("roomId") ? "/chu-tro/cap-nhat-phong" : "/chu-tro/them-phong";
            fetch(actionUrl, {
                method: "POST",
                body: formData
            }).then(response => {
                if (response.redirected) {
                    window.location.href = response.url;
                } else {
                    RoomManagementUI.showNotification("Có lỗi xảy ra!", "error");
                }
            });
        });

        document.addEventListener("click", function(e) {
            if (e.target.closest(".btn-edit-host")) {
                e.preventDefault();
                const roomId = e.target.closest(".btn-edit-host").getAttribute("data-room-id");
                fetch(`/chu-tro/cap-nhat-phong/${roomId}`, {
                    method: "GET",
                    headers: { "Accept": "application/json" }
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error("Không thể tải thông tin phòng");
                    }
                    return response.json();
                })
                .then(data => {
                    console.log("Data from API:", data); // Log dữ liệu để kiểm tra
                    const form = document.getElementById("addRoomFormHost");
                    form.action = "/chu-tro/cap-nhat-phong";
                    document.getElementById("submitBtnText").textContent = "Cập nhật phòng";
                    document.getElementById("addRoomTabText").textContent = "Chỉnh sửa phòng";
                    document.getElementById("roomIdHost").value = data.roomId;
                    document.getElementById("roomNameHost").value = data.namerooms;
                    document.getElementById("roomPriceHost").value = data.price.toLocaleString("vi-VN");
                    document.getElementById("roomAreaHost").value = data.acreage;
                    document.getElementById("roomStatusHost").value = data.status;
                    document.getElementById("roomCapacityHost").value = data.maxTenants;
                    document.getElementById("roomAreaSelectHost").value = data.hostelId;
                    document.getElementById("roomDescriptionHost").value = data.description || "";

                    document.querySelectorAll("input[name='amenities']").forEach(checkbox => {
                        checkbox.checked = data.amenities.includes(checkbox.value);
                    });

                    RoomManagementUI.switchToTab("add-room-tab-host");
                })
                .catch(error => {
                    RoomManagementUI.showNotification("Không thể tải thông tin phòng: " + error.message, "error");
                    console.error("Error:", error);
                });
            }
        });
    </script>
</body>
</html>