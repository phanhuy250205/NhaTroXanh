<!DOCTYPE html>
<html lang="vi">

<head th:replace="~{/layouts/head}">
  <title>Quản lý yêu cầu gia hạn / trả phòng</title>
</head>
<style>
  /* Main Container & General Styles */
  .main-content {
    background-color: #f8fafc;
    padding: 2rem;
    min-height: calc(100vh - 60px);
  }

  /* Header Styles */
  h4.mb-4 {
    color: #1e293b;
    font-weight: 600;
    font-size: 1.75rem;
    position: relative;
    padding-bottom: 0.5rem;
  }

  h4.mb-4::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 60px;
    height: 4px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    border-radius: 2px;
  }

  hr {
    border: 0;
    height: 1px;
    background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(59, 130, 246, 0.5), rgba(0, 0, 0, 0));
    margin: 1.5rem 0;
  }

  /* Toast Notifications */
  .custom-toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1100;
    max-width: 350px;
  }

  .custom-toast {
    display: flex;
    align-items: center;
    padding: 1rem 1.25rem;
    margin-bottom: 1rem;
    border-radius: 12px;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    opacity: 0;
    transform: translateY(20px);
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    position: relative;
    overflow: hidden;
  }

  .custom-toast.show {
    opacity: 1;
    transform: translateY(0);
  }

  .custom-toast::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    width: 5px;
    height: 100%;
  }

  .custom-toast.success {
    background-color: #f0fdf4;
    border-left: 5px solid #10b981;
  }

  .custom-toast.error {
    background-color: #fef2f2;
    border-left: 5px solid #ef4444;
  }

  .toast-icon {
    font-size: 1.5rem;
    margin-right: 1rem;
  }

  .success .toast-icon {
    color: #10b981;
  }

  .error .toast-icon {
    color: #ef4444;
  }

  .toast-message {
    flex: 1;
    color: #1e293b;
    font-weight: 500;
  }

  .toast-close {
    background: none;
    border: none;
    color: #64748b;
    font-size: 1.25rem;
    cursor: pointer;
    margin-left: 0.75rem;
    transition: color 0.2s;
  }

  .toast-close:hover {
    color: #1e293b;
  }

  /* Tabs Navigation */
  .nav-tabs {
    border-bottom: none;
    position: relative;
    margin-bottom: 1.5rem;
  }

  .nav-tabs::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #e2e8f0;
    z-index: 0;
  }

  .nav-tabs .nav-link {
    color: #64748b;
    font-weight: 600;
    border: none;
    padding: 0.75rem 1.5rem;
    border-radius: 8px 8px 0 0;
    transition: all 0.3s ease;
    position: relative;
    z-index: 1;
    margin-right: 0.5rem;
    background-color: transparent;
  }

  .nav-tabs .nav-link:hover {
    color: #3b82f6;
    background-color: rgba(59, 130, 246, 0.05);
  }

  .nav-tabs .nav-link.active {
    color: #3b82f6;
    background-color: rgba(59, 130, 246, 0.1);
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.1), 0 2px 4px -1px rgba(59, 130, 246, 0.06);
  }

  .nav-tabs .nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 3px;
    background: linear-gradient(90deg, #3b82f6, #6366f1);
    border-radius: 3px 3px 0 0;
    z-index: 2;
  }

  /* Search Form */
  .search-rounded {
    border-radius: 50px !important;
    padding: 0.75rem 1.25rem;
    border: 1px solid #e2e8f0;
    transition: all 0.3s;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  }

  .search-rounded:focus {
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
  }

  .btn-search-rounded {
    border-radius: 50px !important;
    padding: 0.75rem 1.5rem;
    background-color: #3b82f6;
    color: white;
    font-weight: 600;
    transition: all 0.3s;
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3), 0 2px 4px -1px rgba(59, 130, 246, 0.1);
  }

  .btn-search-rounded:hover {
    background-color: #2563eb;
    transform: translateY(-2px);
    box-shadow: 0 10px 15px -3px rgba(59, 130, 246, 0.3), 0 4px 6px -2px rgba(59, 130, 246, 0.1);
  }

  /* Cards */
  .card {
    border: none;
    border-radius: 12px;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }

  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .card-title {
    color: #1e293b;
    font-weight: 600;
    margin-bottom: 1rem;
    font-size: 1.1rem;
  }

  .card-text {
    color: #64748b;
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  .card-text strong {
    color: #475569;
  }

  /* Badges */
  .badge {
    padding: 0.35em 0.65em;
    font-weight: 600;
    letter-spacing: 0.5px;
    font-size: 0.75rem;
    border-radius: 50px;
  }

  .bg-warning {
    background-color: #f59e0b !important;
    color: white !important;
  }

  .bg-success {
    background-color: #10b981 !important;
    color: white !important;
  }

  .bg-danger {
    background-color: #ef4444 !important;
    color: white !important;
  }

  /* Buttons */
  .btn-outline-primary {
    border: 1px solid #3b82f6;
    color: #3b82f6;
    font-weight: 500;
    border-radius: 8px;
    transition: all 0.3s;
  }

  .btn-outline-primary:hover {
    background-color: #3b82f6;
    color: white;
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3), 0 2px 4px -1px rgba(59, 130, 246, 0.1);
  }

  .host-btn-approve {
    background-color: #10b981;
    color: white;
    font-weight: 500;
    border-radius: 8px;
    transition: all 0.3s;
    padding: 0.5rem 1.25rem;
  }

  .host-btn-approve:hover {
    background-color: #0d9c6e;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(16, 185, 129, 0.3), 0 2px 4px -1px rgba(16, 185, 129, 0.1);
  }

  .host-btn-reject {
    background-color: #ef4444;
    color: white;
    font-weight: 500;
    border-radius: 8px;
    transition: all 0.3s;
    padding: 0.5rem 1.25rem;
  }

  .host-btn-reject:hover {
    background-color: #dc2626;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px -1px rgba(239, 68, 68, 0.3), 0 2px 4px -1px rgba(239, 68, 68, 0.1);
  }

  /* Modal Styles */
  .host-modal {
    max-width: 800px;
  }

  .host-modal-content {
    border: none;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }

  .host-modal-header {
    background-color: #f8fafc;
    border-bottom: 1px solid #e2e8f0;
    padding: 1.5rem;
  }

  .host-modal-title {
    color: #1e293b;
    font-weight: 600;
    display: flex;
    align-items: center;
  }

  .host-modal-title i {
    font-size: 1.5rem;
    margin-right: 0.75rem;
  }

  .host-modal-body {
    padding: 1.5rem;
    color: #475569;
  }

  .host-modal-footer {
    background-color: #f8fafc;
    border-top: 1px solid #e2e8f0;
    padding: 1.25rem 1.5rem;
  }

  .btn-close {
    background-size: 0.8rem;
    opacity: 0.7;
    transition: opacity 0.2s;
  }

  .btn-close:hover {
    opacity: 1;
  }

  /* Pagination */
  .pagination-guest {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 2rem;
    padding: 1rem 0;
    border-top: 1px solid #e2e8f0;
  }

  .pagination-info-guest {
    color: #64748b;
    font-size: 0.9rem;
  }

  .pagination-controls-guest {
    display: flex;
    gap: 0.5rem;
  }

  .page-btn-guest {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 8px;
    background-color: white;
    color: #64748b;
    font-weight: 500;
    border: 1px solid #e2e8f0;
    transition: all 0.2s;
  }

  .page-btn-guest:hover {
    background-color: #f1f5f9;
    color: #3b82f6;
    border-color: #e2e8f0;
  }

  .page-btn-guest.active {
    background-color: #3b82f6;
    color: white;
    border-color: #3b82f6;
    box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.3), 0 2px 4px -1px rgba(59, 130, 246, 0.1);
  }

  .page-btn-guest.disabled {
    opacity: 0.5;
    cursor: not-allowed;
    background-color: #f8fafc;
  }

  /* Responsive Adjustments */
  @media (max-width: 768px) {
    .main-content {
      padding: 1.5rem;
    }

    .nav-tabs .nav-link {
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
    }

    .search-rounded {
      width: 100%;
    }

    .pagination-guest {
      flex-direction: column;
      gap: 1rem;
    }
  }

  /* Animation for empty state */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }

    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .text-center.p-3 {
    animation: fadeIn 0.5s ease-out;
    color: #64748b;
    padding: 2rem !important;
    background-color: #f8fafc;
    border-radius: 12px;
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
  }
</style>

<body>
  <div th:replace="~{/layouts/sidebar-host}"></div>
  <div class="main-content">
    <h4 class="mb-4">Quản lý yêu cầu gia hạn / trả phòng</h4>
    <hr>

    <!-- Toast Notifications -->
    <div class="custom-toast-container">
      <div th:if="${successMessage}" class="custom-toast success">
        <i class="toast-icon fas fa-check-circle"></i>
        <span class="toast-message" th:text="${successMessage}"></span>
        <button class="toast-close" aria-label="Đóng">×</button>
      </div>
      <div th:if="${errorMessage}" class="custom-toast error">
        <i class="toast-icon fas fa-exclamation-circle"></i>
        <span class="toast-message" th:text="${errorMessage}"></span>
        <button class="toast-close" aria-label="Đóng">×</button>
      </div>
    </div>

    <!-- Tab Navigation -->
    <ul class="nav nav-tabs mb-3">
      <li class="nav-item">
        <a class="nav-link" th:classappend="${tab == 'extension' ? 'active' : ''}"
          th:href="@{/chu-tro/gia-hang-tra-phong(tab='extension', page=0, size=${size}, keyword=${keyword})}">Gia
          Hạn</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" th:classappend="${tab == 'return' ? 'active' : ''}"
          th:href="@{/chu-tro/gia-hang-tra-phong(tab='return', page=0, size=${size}, keyword=${keyword})}">Trả Phòng</a>
      </li>
    </ul>

    <!-- Search Form -->
    <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
      <form th:action="@{/chu-tro/gia-hang-tra-phong}" method="get" class="d-flex flex-grow-1 gap-3"
        style="max-width: 500px;">
        <input type="text" name="keyword" class="form-control search-rounded"
          placeholder="Tìm kiếm theo tên người thuê hoặc phòng" th:value="${keyword}" />
        <input type="hidden" name="page" value="0" />
        <input type="hidden" name="size" th:value="${size}" />
        <input type="hidden" name="tab" th:value="${tab}" />
        <button type="submit" class="btn btn-search-rounded">TÌM KIẾM</button>
      </form>
    </div>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Extension Requests Tab -->
      <div th:if="${tab == 'extension'}" id="extension" class="tab-pane active">
        <div class="row row-cols-1 row-cols-md-3 g-4" th:if="${requests != null and not #lists.isEmpty(requests)}">
          <div class="col" th:each="req, iterStat : ${requests}">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h5 class="card-title"
                  th:text="${req.contract.tenant != null ? req.contract.tenant.fullname : req.contract.unregisteredTenant.fullname}">
                  Tên người thuê</h5>
                <p class="card-text mb-1">
                  <strong>Phòng:</strong> <span th:text="${req.contract.room.namerooms}">Tên phòng</span>
                </p>
                <p class="card-text mb-1">
                  <strong>Loại yêu cầu:</strong> Gia hạn
                </p>
                <p class="card-text mb-1">
                  <strong>Trạng thái:</strong>
                  <span th:switch="${req.status}">
                    <span th:case="${RequestStatus.PENDING}" class="badge bg-warning text-dark">Chờ duyệt</span>
                    <span th:case="${RequestStatus.APPROVED}" class="badge bg-success">Đã duyệt</span>
                    <span th:case="${RequestStatus.REJECTED}" class="badge bg-danger">Đã từ chối</span>
                  </span>
                </p>
                <p class="card-text mb-1">
                  <strong>Thời gian:</strong>
                  <span th:text="${#dates.format(req.contract.endDate, 'dd/MM/yyyy')}"></span>
                  → <span th:text="${#dates.format(req.requestedExtendDate, 'dd/MM/yyyy')}"></span>
                </p>
                <button class="btn btn-outline-primary btn-sm mt-3" data-bs-toggle="modal"
                  th:attr="data-bs-target='#requestModal__' + ${iterStat.index}">
                  <i class="fa-solid fa-eye"></i> Xem chi tiết
                </button>
              </div>
            </div>

            <!-- Modal for Extension Request Details -->
            <div class="modal fade" th:id="'requestModal__' + ${iterStat.index}" tabindex="-1"
              aria-labelledby="'host-modal-title__' + ${iterStat.index}" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-lg host-modal">
                <div class="modal-content host-modal-content shadow-sm">
                  <div class="modal-header border-0">
                    <h5 class="modal-title" th:id="'host-modal-title__' + ${iterStat.index}">
                      <i class="fa-solid fa-file-signature me-2 text-primary"></i>Chi tiết yêu cầu gia hạn
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                  </div>
                  <div class="modal-body host-modal-body">
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-user me-1 text-secondary"></i>
                        <strong>Họ tên:</strong>
                        <span
                          th:text="${req.contract.tenant != null ? req.contract.tenant.fullname : req.contract.unregisteredTenant.fullname}"></span>
                      </div>
                    </div>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-door-open me-1 text-secondary"></i>
                        <strong>Phòng:</strong> <span th:text="${req.contract.room.namerooms}"></span>
                      </div>
                      <div class="col-md-6">
                        <i class="fa-solid fa-file-contract me-1 text-secondary"></i>
                        <strong>Hợp đồng:</strong> <span th:text="'#CTR' + ${req.contract.contractId}"></span>
                      </div>
                    </div>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-tag me-1 text-secondary"></i>
                        <strong>Loại yêu cầu:</strong> Gia hạn
                      </div>
                      <div class="col-md-6">
                        <i class="fa-solid fa-calendar me-1 text-secondary"></i>
                        <strong>Thời gian hiện tại:</strong>
                        <span th:text="${#dates.format(req.contract.startDate, 'dd/MM/yyyy')}"></span>
                        – <span th:text="${#dates.format(req.contract.endDate, 'dd/MM/yyyy')}"></span>
                      </div>
                    </div>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-calendar-plus me-1 text-secondary"></i>
                        <strong>Gia hạn đến:</strong> <span
                          th:text="${#dates.format(req.requestedExtendDate, 'dd/MM/yyyy')}"></span>
                      </div>
                    </div>
                    <div class="mt-3">
                      <i class="fa-solid fa-pen me-1 text-secondary"></i>
                      <strong>Lý do:</strong> <span th:text="${req.message != null ? req.message : 'Không có'}">Không
                        có</span>
                    </div>
                  </div>
                  <div class="modal-footer border-0 pt-0" th:if="${req.status == RequestStatus.PENDING}">
                    <form th:action="@{/chu-tro/gia-hang-tra-phong/duyet}" method="post" class="me-2">
                      <input type="hidden" name="requestId" th:value="${req.requestId}">
                      <button type="submit" class="btn host-btn-approve">
                        <i class="fa-solid fa-check me-1"></i> Phê duyệt
                      </button>
                    </form>
                    <form th:action="@{/chu-tro/gia-hang-tra-phong/tu-choi}" method="post">
                      <input type="hidden" name="requestId" th:value="${req.requestId}">
                      <button type="submit" class="btn host-btn-reject">
                        <i class="fa-solid fa-xmark me-1"></i> Từ chối
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div th:if="${requests == null or #lists.isEmpty(requests)}" class="text-center p-3">
          Không có yêu cầu gia hạn nào.
        </div>
      </div>

      <!-- Return Room Requests Tab -->
      <div th:if="${tab == 'return'}" id="return" class="tab-pane active">
        <div class="row row-cols-1 row-cols-md-3 g-4"
          th:if="${returnRequests != null and not #lists.isEmpty(returnRequests)}">
          <div class="col" th:each="contract, iterStat : ${returnRequests}">
            <div class="card shadow-sm h-100">
              <div class="card-body">
                <h5 class="card-title"
                  th:text="${contract.tenant != null ? contract.tenant.fullname : contract.unregisteredTenant.fullname}">
                  Tên người thuê</h5>
                <p class="card-text mb-1">
                  <strong>Phòng:</strong> <span th:text="${contract.room.namerooms}">Tên phòng</span>
                </p>
                <p class="card-text mb-1">
                  <strong>Loại yêu cầu:</strong> Trả phòng
                </p>
                <p class="card-text mb-1">
                  <strong>Trạng thái:</strong>
                  <span th:switch="${contract.returnStatus}">
                    <span th:case="${ReturnStatus.PENDING}" class="badge bg-warning text-dark">Chờ duyệt</span>
                    <span th:case="${ReturnStatus.APPROVED}" class="badge bg-success">Đã duyệt</span>
                    <span th:case="${ReturnStatus.REJECTED}" class="badge bg-danger">Đã từ chối</span>
                  </span>
                </p>
                <p class="card-text mb-1">
                  <strong>Thời gian kết thúc:</strong>
                  <span th:text="${#dates.format(contract.endDate, 'dd/MM/yyyy')}"></span>
                </p>
                <button class="btn btn-outline-primary btn-sm mt-3" data-bs-toggle="modal"
                  th:attr="data-bs-target='#returnModal__' + ${iterStat.index}">
                  <i class="fa-solid fa-eye"></i> Xem chi tiết
                </button>
              </div>
            </div>

            <div class="modal fade" th:id="'returnModal__' + ${iterStat.index}" tabindex="-1"
              aria-labelledby="'host-return-modal-title__' + ${iterStat.index}" aria-hidden="true">
              <div class="modal-dialog modal-dialog-centered modal-lg host-modal">
                <div class="modal-content host-modal-content shadow-sm">
                  <div class="modal-header border-0">
                    <h5 class="modal-title" th:id="'host-return-modal-title__' + ${iterStat.index}">
                      <i class="fa-solid fa-file-signature me-2 text-primary"></i>Chi tiết yêu cầu trả phòng
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Đóng"></button>
                  </div>
                  <div class="modal-body host-modal-body">
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-user me-1 text-secondary"></i>
                        <strong>Họ tên:</strong>
                        <span
                          th:text="${contract.tenant != null ? contract.tenant.fullname : contract.unregisteredTenant.fullname}"></span>
                      </div>
                    </div>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-door-open me-1 text-secondary"></i>
                        <strong>Phòng:</strong> <span th:text="${contract.room.namerooms}"></span>
                      </div>
                      <div class="col-md-6">
                        <i class="fa-solid fa-file-contract me-1 text-secondary"></i>
                        <strong>Hợp đồng:</strong> <span th:text="'#CTR' + ${contract.contractId}"></span>
                      </div>
                    </div>
                    <div class="row mb-2">
                      <div class="col-md-6">
                        <i class="fa-solid fa-tag me-1 text-secondary"></i>
                        <strong>Loại yêu cầu:</strong> Trả phòng
                      </div>
                      <div class="col-md-6">
                        <i class="fa-solid fa-calendar me-1 text-secondary"></i>
                        <strong>Thời gian hợp đồng:</strong>
                        <span th:text="${#dates.format(contract.startDate, 'dd/MM/yyyy')}"></span>
                        – <span th:text="${#dates.format(contract.endDate, 'dd/MM/yyyy')}"></span>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer border-0 pt-0" th:if="${contract.returnStatus == ReturnStatus.PENDING}">
                    <form th:action="@{/chu-tro/gia-hang-tra-phong/duyet-tra-phong/{id}(id=${contract.contractId})}"
                      method="post" class="me-2">
                      <button type="submit" class="btn host-btn-approve">
                        <i class="fa-solid fa-check me-1"></i> Phê duyệt
                      </button>
                    </form>
                    <form th:action="@{/chu-tro/gia-hang-tra-phong/tu-choi-tra-phong/{id}(id=${contract.contractId})}"
                      method="post">
                      <button type="submit" class="btn host-btn-reject">
                        <i class="fa-solid fa-xmark me-1"></i> Từ chối
                      </button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div th:if="${returnRequests == null or #lists.isEmpty(returnRequests)}" class="text-center p-3">
          Không có yêu cầu trả phòng nào.
        </div>
      </div>
    </div>

    <!-- Pagination -->
    <div class="pagination-guest" th:if="${totalItems > 0}">
      <div class="pagination-info-guest">
        <span th:text="'Hiển thị ' + ${totalItems} + ' kết quả'">Hiển thị 0 kết quả</span>
      </div>
      <div class="pagination-controls-guest">
        <a th:if="${currentPage > 0}"
          th:href="@{/chu-tro/gia-hang-tra-phong(page=${currentPage - 1}, size=${size}, keyword=${keyword}, tab=${tab})}"
          class="page-btn-guest" aria-label="Trang trước">Trước</a>
        <span th:if="${currentPage == 0}" class="page-btn-guest disabled" aria-disabled="true">Trước</span>
        <a th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
          th:href="@{/chu-tro/gia-hang-tra-phong(page=${i}, size=${size}, keyword=${keyword}, tab=${tab})}"
          th:text="${i + 1}" th:classappend="${i == currentPage} ? 'active' : ''" class="page-btn-guest"
          th:attr="aria-label='Trang ' + ${i + 1}"></a>
        <a th:if="${currentPage < totalPages - 1}"
          th:href="@{/chu-tro/gia-hang-tra-phong(page=${currentPage + 1}, size=${size}, keyword=${keyword}, tab=${tab})}"
          class="page-btn-guest" aria-label="Trang sau">Sau</a>
        <span th:if="${currentPage == totalPages - 1 || totalPages == 0}" class="page-btn-guest disabled"
          aria-disabled="true">Sau</span>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Toast auto-dismiss
      document.querySelectorAll('.toast-close').forEach(btn => {
        btn.addEventListener('click', () => {
          const toast = btn.closest('.custom-toast');
          toast.style.opacity = '0';
          setTimeout(() => toast.remove(), 300);
        });
      });
      setTimeout(() => {
        document.querySelectorAll('.custom-toast').forEach(toast => {
          toast.style.opacity = '0';
          setTimeout(() => toast.remove(), 300);
        });
      }, 3000);

      // Debug pagination data
      console.log('Pagination Data:', {
        totalItems: parseInt('[[${totalItems}]]') || 0,
        totalPages: parseInt('[[${totalPages}]]') || 0,
        currentPage: parseInt('[[${currentPage}]]') || 0,
        size: parseInt('[[${size}]]') || 6,
        keyword: '[[${keyword}]]' || '',
        tab: '[[${tab}]]' || 'extension'
      });
    });
  </script>
</body>

</html>