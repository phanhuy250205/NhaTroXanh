<!DOCTYPE html>
<html lang="en">

<!-- <head th:replace="~{/layouts/head}">
    <title>Chi Tiết - Nhà Trọ Xanh</title>
</head> -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Tiết Bài Đăng</title>
    <link rel="stylesheet" th:href="@{/css/sidebar.css}" />
    <link rel="icon" th:href="@{/images/logo/nhatroxanh(title).png}" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="stylesheet" th:href="@{/css/host.css}" />
    <link rel="stylesheet" th:href="@{/bootstrap/css/bootstrap.min.css}" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    
</head>

<body>
    <!-- NAVBAR -->
    <div th:replace="~{/layouts/sidebar-host}"></div>
    <!-- Main Content -->
    <div class="nha-tro-main-content">
        <div class="nha-tro-header">
            <h5>
                <a href="javascript:history.back()" class="nha-tro-back-btn">
                    <i class="fa fa-arrow-left"></i>
                </a>
                Tạo hợp đồng thuê nhà
            </h5>
            <hr>
        </div>

        <div class="container-fluid mt-4">
            <div class="row mt-3">
                <!-- Form Column -->
                <div class="col-lg-7">
                    <!-- Basic Info Card -->
                    <div class="card nha-tro-card mb-3">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-4">
                                    <label class="form-label">Số điện thoại</label>
                                    <input type="text" class="form-control" placeholder="Số điện thoại người thuê" id="tenant-phone">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Ngày lập hợp đồng</label>
                                    <input type="date" class="form-control" id="contract-date">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Trạng thái</label>
                                    <select class="form-select" id="contract-status">
                                        <option value="">Trạng thái</option>
                                        <option value="active">Đang hiệu lực</option>
                                        <option value="expired">Hết hiệu lực</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabs Navigation -->
                    <ul class="nav nav-tabs nha-tro-tabs" id="contractTabs">
                        <li class="nav-item">
                            <a class="nav-link active" data-tab="tenantInfo" href="#tenantInfo">
                                <i class="fa fa-user me-2"></i> Người thuê
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-tab="ownerInfo" href="#ownerInfo">
                                <i class="fa fa-id-card me-2"></i> Chủ trọ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-tab="roomInfo" href="#roomInfo">
                                <i class="fa fa-house me-2"></i> Nhà trọ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-tab="terms" href="#terms">
                                <i class="fa fa-file-contract me-2"></i> Điều khoản
                            </a>
                        </li>
                    </ul>

                    <!-- Tab Content -->
                    <div class="tab-content card p-4 nha-tro-tab-content" style="border-radius: 0px;">
                        <!-- Tenant Info Tab -->
                        <div class="tab-pane fade show active" id="tenantInfo">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="mb-0">Thông tin người thuê</h6>
                                <button type="button" class="btn btn-outline-success btn-sm nha-tro-host-btn-add-customer" id="btn-add-customer-host">
                                    <i class="fa fa-user-plus me-1"></i> Thêm khách mới
                                </button>
                            </div>
                            <hr class="mb-4">

                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Họ và tên</label>
                                    <input type="text" class="form-control" id="tenant-name">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Ngày sinh</label>
                                    <input type="date" class="form-control" id="tenant-dob">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Số CMND/CCCD</label>
                                    <input type="text" class="form-control" id="tenant-id">
                                </div>
                                <div class="col-md-5">
                                    <label class="form-label">Ngày cấp</label>
                                    <input type="date" class="form-control" id="tenant-id-date">
                                </div>
                                <div class="col-md-7">
                                    <label class="form-label">Nơi cấp</label>
                                    <input type="text" class="form-control" id="tenant-id-place">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Tỉnh/Thành phố</label>
                                    <select class="form-select" id="tenant-province">
                                        <option value="">Tỉnh/Thành phố</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Quận/Huyện</label>
                                    <select class="form-select" id="tenant-district">
                                        <option value="">Quận/Huyện</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Phường/Xã</label>
                                    <select class="form-select" id="tenant-ward">
                                        <option value="">Phường/Xã</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tên đường/Số nhà</label>
                                    <input type="text" class="form-control" id="tenant-street">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Email (nếu có)</label>
                                    <input type="email" class="form-control" id="tenant-email">
                                </div>

                                <!-- CCCD Images -->
                                <div class="col-md-6">
                                    <label class="form-label">Ảnh CCCD mặt trước</label>
                                    <div class="nha-tro-image-upload" onclick="document.getElementById('cccd-front').click()">
                                        <input type="file" id="cccd-front" accept="image/*" style="display: none;">
                                        <div id="cccd-front-preview" class="nha-tro-image-preview">
                                            <i class="fa fa-camera fa-2x"></i>
                                            <div class="mt-2">Tải ảnh mặt trước</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label">Ảnh CCCD mặt sau</label>
                                    <div class="nha-tro-image-upload" onclick="document.getElementById('cccd-back').click()">
                                        <input type="file" id="cccd-back" accept="image/*" style="display: none;">
                                        <div id="cccd-back-preview" class="nha-tro-image-preview">
                                            <i class="fa fa-camera fa-2x"></i>
                                            <div class="mt-2">Tải ảnh mặt sau</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-flex justify-content-end mt-4">
                                <button class="btn btn-primary nha-tro-btn-next" id="btn-next-owner">
                                    Tiếp tục <i class="fa fa-arrow-right ms-1"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Owner Info Tab -->
                        <div class="tab-pane fade" id="ownerInfo">
                            <h6 class="mb-3">Thông tin chủ trọ</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Họ và tên</label>
                                    <input type="text" class="form-control" id="owner-name">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Ngày sinh</label>
                                    <input type="date" class="form-control" id="owner-dob">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Số CMND/CCCD</label>
                                    <input type="text" class="form-control" id="owner-id">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Ngày cấp</label>
                                    <input type="date" class="form-control" id="owner-id-date">
                                </div>
                                <div class="col-md-9">
                                    <label class="form-label">Nơi cấp</label>
                                    <input type="text" class="form-control" id="owner-id-place">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Tỉnh/Thành phố</label>
                                    <select class="form-select" id="owner-province">
                                        <option value="">Tỉnh/Thành phố</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Quận/Huyện</label>
                                    <select class="form-select" id="owner-district">
                                        <option value="">Quận/Huyện</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Phường/Xã</label>
                                    <select class="form-select" id="owner-ward">
                                        <option value="">Phường/Xã</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tên đường/Số nhà</label>
                                    <input type="text" class="form-control" id="owner-street">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Email (nếu có)</label>
                                    <input type="email" class="form-control" id="owner-email">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Số điện thoại</label>
                                    <input type="text" class="form-control" id="owner-phone">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tài khoản ngân hàng (nếu có)</label>
                                    <input type="text" class="form-control" id="owner-bank">
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mt-4">
                                <button class="btn btn-secondary" id="btn-prev-tenant">
                                    <i class="fa fa-arrow-left me-1"></i> Quay lại
                                </button>
                                <button class="btn btn-primary nha-tro-btn-next" id="btn-next-room">
                                    Tiếp tục <i class="fa fa-arrow-right ms-1"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Room Info Tab -->
                        <div class="tab-pane fade" id="roomInfo">
                            <h6 class="mb-3">Thông tin nhà trọ</h6>
                            <div class="row g-3">
                                <!-- NEW: Housing Area and Room Selection -->
                                <div class="col-md-6">
                                    <label class="form-label">
                                        <i class="fa fa-building me-1"></i>Chọn khu trọ
                                    </label>
                                    <select class="form-select" id="housing-area">
                                        <option value="">-- Chọn khu trọ --</option>
                                        <option value="khu-a">Khu A - Nguyễn Văn Linh</option>
                                        <option value="khu-b">Khu B - Lê Duẩn</option>
                                        <option value="khu-c">Khu C - Trần Hưng Đạo</option>
                                        <option value="khu-d">Khu D - Hai Bà Trưng</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">
                                        <i class="fa fa-door-open me-1"></i>Chọn phòng trọ
                                    </label>
                                    <select class="form-select" id="room-selection" disabled>
                                        <option value="">-- Chọn phòng trọ --</option>
                                    </select>
                                </div>
                                
                                <div class="col-md-4">
                                    <label class="form-label">Tỉnh/Thành phố</label>
                                    <select class="form-select" id="room-province">
                                        <option value="">Tỉnh/Thành phố</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Quận/Huyện</label>
                                    <select class="form-select" id="room-district">
                                        <option value="">Quận/Huyện</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Phường/Xã</label>
                                    <select class="form-select" id="room-ward">
                                        <option value="">Phường/Xã</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tên đường/Số nhà</label>
                                    <input type="text" class="form-control" id="room-street">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Số phòng</label>
                                    <input type="text" class="form-control" id="room-number">
                                </div>
                                <div class="col-md-3">
                                    <label class="form-label">Diện tích (m²)</label>
                                    <input type="number" class="form-control" id="room-area">
                                </div>

                                <!-- Residents Section -->
                                <div class="col-12">
                                    <div class="d-flex justify-content-between align-items-center mb-3">
                                        <label class="form-label mb-0">
                                            <i class="fa fa-users me-2"></i>Số người ở
                                            <span class="badge bg-primary ms-2" id="residents-count">0</span>
                                        </label>
                                        <button type="button" class="btn btn-outline-primary btn-sm nha-tro-host-btn-add-resident" id="btn-add-resident">
                                            <i class="fa fa-user-plus me-1"></i> Thêm người ở
                                        </button>
                                    </div>
                                    
                                    <div id="residents-list" class="nha-tro-residents-container">
                                        <div class="text-center text-muted py-4" id="no-residents-message">
                                            <i class="fa fa-users fa-2x mb-2"></i>
                                            <p>Chưa có người ở nào được thêm</p>
                                            <small>Nhấn "Thêm người ở" để bắt đầu</small>
                                        </div>
                                    </div>
                                </div>

                                <!-- Amenities Section -->
                                <div class="col-12">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <label class="form-label">Tiện ích</label>
                                        <button type="button" class="btn btn-outline-primary btn-sm nha-tro-host-btn-add-amenity" id="btn-add-amenity-host">
                                            <i class="fa fa-plus me-1"></i> Thêm tiện ích
                                        </button>
                                    </div>
                                    <div class="nha-tro-amenities" id="amenities-list-host">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="wifi">
                                            <label class="form-check-label" for="wifi">Wifi</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="ac">
                                            <label class="form-check-label" for="ac">Máy lạnh</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="fridge">
                                            <label class="form-check-label" for="fridge">Tủ lạnh</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="kitchen">
                                            <label class="form-check-label" for="kitchen">Bếp</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="parking">
                                            <label class="form-check-label" for="parking">Chỗ để xe</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="security">
                                            <label class="form-check-label" for="security">Camera an ninh</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <label class="form-label">Ghi chú</label>
                                    <textarea class="form-control" rows="3" id="room-notes"></textarea>
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mt-4">
                                <button class="btn btn-secondary" id="btn-prev-owner">
                                    <i class="fa fa-arrow-left me-1"></i> Quay lại
                                </button>
                                <button class="btn btn-primary nha-tro-btn-next" id="btn-next-terms">
                                    Tiếp tục <i class="fa fa-arrow-right ms-1"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Terms Tab -->
                        <div class="tab-pane fade" id="terms">
                            <h6 class="mb-3">Điều khoản & Thanh toán</h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label">Giá thuê hàng tháng (VND)</label>
                                    <input type="number" class="form-control" id="rent-price">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Phương thức thanh toán</label>
                                    <select class="form-select" id="payment-method">
                                        <option value="cash">Tiền mặt</option>
                                        <option value="transfer">Chuyển khoản</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Ngày thanh toán hàng tháng</label>
                                    <input type="text" class="form-control" id="payment-date" placeholder="Ví dụ: Ngày 5 hằng tháng">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Thời hạn hợp đồng</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" value="0" id="contract-duration">
                                        <span class="input-group-text">Tháng</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Ngày bắt đầu HĐ</label>
                                    <input type="date" class="form-control" id="start-date">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Đặt cọc trước</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" value="2" id="deposit-months">
                                        <span class="input-group-text">tháng tiền nhà</span>
                                    </div>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Điều khoản chung</label>
                                    <textarea class="form-control" rows="4" id="terms-conditions"></textarea>
                                </div>
                            </div>

                            <div class="d-flex justify-content-start mt-4">
                                <button class="btn btn-secondary" id="btn-prev-room">
                                    <i class="fa fa-arrow-left me-1"></i> Quay lại
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="d-flex flex-wrap justify-content-center gap-2 mt-4">
                        <button class="btn btn-outline-info flex-fill" id="btn-update">
                            <i class="fa fa-pen-to-square me-1"></i> Cập nhật hợp đồng
                        </button>
                        <button class="btn btn-success flex-fill" id="btn-print">
                            <i class="fa fa-print me-1"></i> In hợp đồng
                        </button>
                        <button class="btn nha-tro-btn-purple flex-fill" id="btn-save">
                            <i class="fa fa-floppy-disk me-1"></i> Lưu hợp đồng
                        </button>
                    </div>
                </div>

                <!-- Preview Column -->
                <div class="col-lg-5">
                    <div class="card nha-tro-contract-preview">
                        <div class="card-header bg-light d-flex justify-content-between align-items-center">
                            <strong>Xem trước hợp đồng</strong>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-secondary" id="btn-zoom-out" title="Thu nhỏ">
                                    <i class="fa fa-minus"></i>
                                </button>
                                <button class="btn btn-outline-secondary" id="btn-zoom-in" title="Phóng to">
                                    <i class="fa fa-plus"></i>
                                </button>
                                <button class="btn btn-outline-secondary" id="btn-reset-zoom" title="Kích thước gốc">
                                    <i class="fa fa-refresh"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body nha-tro-preview-content" id="contract-preview">
                            <div id="preview-container" style="transform-origin: top left; transition: transform 0.3s ease;">
                                <div class="text-center mb-4">
                                    <p><strong>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM<br>Độc lập - Tự do - Hạnh phúc</strong></p>
                                    <p><strong>HỢP ĐỒNG THUÊ NHÀ</strong></p>
                                </div>
                                
                                <p>Hôm nay, ngày <span id="preview-sign-date" class="nha-tro-highlight">........................</span>, chúng tôi gồm:</p>

                                <div class="mb-3">
                                    <p><strong>BÊN CHO THUÊ (Bên A):</strong></p>
                                    <p>Họ tên: <span id="preview-owner-name" class="nha-tro-highlight">........................</span></p>
                                    <p>Sinh ngày: <span id="preview-owner-dob" class="nha-tro-highlight">........................</span></p>
                                    <p>Số CMND/CCCD: <span id="preview-owner-id" class="nha-tro-highlight">........................</span> cấp ngày <span id="preview-owner-id-date" class="nha-tro-highlight">........................</span> tại <span id="preview-owner-id-place" class="nha-tro-highlight">........................</span></p>
                                    <p>Địa chỉ: <span id="preview-owner-address" class="nha-tro-highlight">........................</span></p>
                                    <p>Số điện thoại: <span id="preview-owner-phone" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>BÊN THUÊ (Bên B):</strong></p>
                                    <p>Họ tên: <span id="preview-tenant-name" class="nha-tro-highlight">........................</span></p>
                                    <p>Sinh ngày: <span id="preview-tenant-dob" class="nha-tro-highlight">........................</span></p>
                                    <p>Số CMND/CCCD: <span id="preview-tenant-id" class="nha-tro-highlight">........................</span> cấp ngày <span id="preview-tenant-id-date" class="nha-tro-highlight">........................</span> tại <span id="preview-tenant-id-place" class="nha-tro-highlight">........................</span></p>
                                    <p>Địa chỉ: <span id="preview-tenant-address" class="nha-tro-highlight">........................</span></p>
                                    <p>Số điện thoại: <span id="preview-tenant-phone" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <div id="preview-residents-section" style="display: none;" class="mb-3">
                                    <p><strong>Danh sách người ở:</strong><br>
                                    <span id="preview-residents" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <p>Sau khi bàn bạc trên tinh thần dân chủ, hai bên thống nhất ký kết hợp đồng thuê nhà với các điều khoản sau:</p>

                                <div class="mb-3">
                                    <p><strong>Điều 1: Đối tượng hợp đồng</strong></p>
                                    <p>Bên A đồng ý cho Bên B thuê căn nhà tại địa chỉ: <span id="preview-room-address" class="nha-tro-highlight">........................</span>, phòng số <span id="preview-room-number" class="nha-tro-highlight">........................</span>, diện tích <span id="preview-room-area" class="nha-tro-highlight">........................</span> m².</p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>Điều 2: Thời hạn thuê</strong></p>
                                    <p>Thời gian thuê: <span id="preview-duration" class="nha-tro-highlight">........................</span> tháng, kể từ ngày <span id="preview-start-date" class="nha-tro-highlight">........................</span> đến ngày <span id="preview-end-date" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>Điều 3: Giá thuê và phương thức thanh toán</strong></p>
                                    <p>Giá thuê: <span id="preview-rent" class="nha-tro-highlight">........................</span> VNĐ/tháng. Thanh toán <span id="preview-payment-date" class="nha-tro-highlight">........................</span> bằng <span id="preview-payment-method" class="nha-tro-highlight">........................</span>.</p>
                                    <p>Tiền đặt cọc: <span id="preview-deposit" class="nha-tro-highlight">........................</span> VNĐ (tương đương <span id="preview-deposit-months" class="nha-tro-highlight">........................</span> tháng tiền nhà).</p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>Điều 4: Tiện ích và trang thiết bị</strong></p>
                                    <p>Phòng được trang bị: <span id="preview-amenities" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>Điều 5: Trách nhiệm các bên</strong></p>
                                    <p>Bên A cam kết giao nhà đúng thời gian và đúng hiện trạng. Bên B có trách nhiệm sử dụng đúng mục đích, bảo quản tài sản và trả nhà đúng hạn.</p>
                                </div>

                                <div class="mb-3">
                                    <p><strong>Điều 6: Điều khoản khác</strong></p>
                                    <p><span id="preview-terms" class="nha-tro-highlight">........................</span></p>
                                </div>

                                <div class="mb-4">
                                    <p><strong>Điều 7: Cam kết chung</strong></p>
                                    <p>Hai bên cam kết thực hiện đúng các điều khoản. Nếu có tranh chấp, sẽ giải quyết theo pháp luật Việt Nam.</p>
                                </div>

                                <p class="mb-4">Hợp đồng được lập thành 02 bản, mỗi bên giữ 01 bản và có giá trị pháp lý như nhau.</p>

                                <div class="row text-center mt-5">
                                    <div class="col-6">
                                        <p><strong>BÊN CHO THUÊ</strong></p>
                                        <p class="mt-5">(Ký, ghi rõ họ tên)</p>
                                        <p><span id="preview-owner-signature" class="nha-tro-highlight">........................</span></p>
                                    </div>
                                    <div class="col-6">
                                        <p><strong>BÊN THUÊ</strong></p>
                                        <p class="mt-5">(Ký, ghi rõ họ tên)</p>
                                        <p><span id="preview-tenant-signature" class="nha-tro-highlight">........................</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add Resident Modal -->
    <div class="modal fade" id="addResidentModal" tabindex="-1" aria-labelledby="addResidentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content nha-tro-host-modal">
                <div class="modal-header nha-tro-host-modal-header">
                    <h5 class="modal-title" id="addResidentModalLabel">
                        <i class="fa fa-user-plus me-2"></i>Thêm người ở
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body nha-tro-host-modal-body">
                    <!-- <div class="mb-4">
                        <h6 class="mb-3">
                            <i class="fa fa-search me-2"></i>Tìm khách đã có trong hệ thống
                        </h6>
                        <div class="input-group">
                            <input type="text" class="form-control" id="search-customer-phone" placeholder="Nhập số điện thoại để tìm kiếm...">
                            <button class="btn btn-outline-primary" type="button" id="btn-search-customer">
                                <i class="fa fa-search"></i> Tìm kiếm
                            </button>
                        </div>
                        <div id="search-results" class="mt-3"></div>
                    </div>

                    <div class="text-center my-3">
                        <span class="text-muted">── HOẶC ──</span>
                    </div> -->

                    <div>
                        <h6 class="mb-3">
                            <i class="fa fa-user-plus me-2"></i>Thêm người mới
                        </h6>
                        <form id="addResidentForm">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <label class="form-label">Họ và tên <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="resident-name" required>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Năm sinh <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" id="resident-birth-year" min="1900" max="2024" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Số điện thoại</label>
                                    <input type="tel" class="form-control" id="resident-phone">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Số CMND/CCCD</label>
                                    <input type="text" class="form-control" id="resident-id">
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Ghi chú</label>
                                    <textarea class="form-control" id="resident-notes" rows="2" placeholder="Ghi chú thêm về người ở..."></textarea>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div class="modal-footer nha-tro-host-modal-footer">
                    <button type="button" class="btn btn-secondary nha-tro-host-btn-cancel" data-bs-dismiss="modal">
                        <i class="fa fa-times me-1"></i>Hủy
                    </button>
                    <button type="button" class="btn btn-success nha-tro-host-btn-save" id="btn-save-resident">
                        <i class="fa fa-check me-1"></i>Thêm người ở
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Amenity Modal -->
    <div class="modal fade" id="addAmenityModal-host" tabindex="-1" aria-labelledby="addAmenityModalLabel-host" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content nha-tro-host-modal">
                <div class="modal-header nha-tro-host-modal-header">
                    <h5 class="modal-title" id="addAmenityModalLabel-host">
                        <i class="fa fa-plus-circle me-2"></i>Thêm tiện ích mới
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body nha-tro-host-modal-body">
                    <form id="addAmenityForm-host">
                        <div class="mb-3">
                            <label for="amenityName-host" class="form-label">Tên tiện ích</label>
                            <input type="text" class="form-control nha-tro-host-input" id="amenityName-host" placeholder="Nhập tên tiện ích..." required>
                            <div class="invalid-feedback">
                                Vui lòng nhập tên tiện ích
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer nha-tro-host-modal-footer">
                    <button type="button" class="btn btn-secondary nha-tro-host-btn-cancel" data-bs-dismiss="modal">
                        <i class="fa fa-times me-1"></i>Hủy
                    </button>
                    <button type="button" class="btn btn-primary nha-tro-host-btn-save" id="saveAmenity-host">
                        <i class="fa fa-check me-1"></i>Lưu tiện ích
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add New Customer Modal -->
    <div class="modal fade" id="addCustomerModal-host" tabindex="-1" aria-labelledby="addCustomerModalLabel-host" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content nha-tro-host-modal">
                <div class="modal-header nha-tro-host-modal-header">
                    <h5 class="modal-title" id="addCustomerModalLabel-host">
                        <i class="fa fa-user-plus me-2"></i>Thêm khách thuê mới
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body nha-tro-host-modal-body">
                    <form id="addCustomerForm-host">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Họ và tên</label>
                                <input type="text" class="form-control nha-tro-host-input" id="newCustomer-name">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Ngày sinh</label>
                                <input type="date" class="form-control nha-tro-host-input" id="newCustomer-dob">
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Số CMND/CCCD</label>
                                <input type="text" class="form-control nha-tro-host-input" id="newCustomer-id">
                            </div>
                            <div class="col-md-5">
                                <label class="form-label">Ngày cấp</label>
                                <input type="date" class="form-control nha-tro-host-input" id="newCustomer-id-date">
                            </div>
                            <div class="col-md-7">
                                <label class="form-label">Nơi cấp</label>
                                <input type="text" class="form-control nha-tro-host-input" id="newCustomer-id-place">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Số điện thoại</label>
                                <input type="tel" class="form-control nha-tro-host-input" id="newCustomer-phone">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Email (tùy chọn)</label>
                                <input type="email" class="form-control nha-tro-host-input" id="newCustomer-email">
                            </div>
                            <div class="col-12">
                                <hr class="my-4">
                                <h6 class="mb-0">
                                    <i class="fa fa-users me-2"></i>Mối quan hệ
                                </h6>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Mối quan hệ với chủ hợp đồng</label>
                                <select class="form-select nha-tro-host-input" id="newCustomer-relationship">
                                    <option value="">Chọn mối quan hệ</option>
                                    <option value="chu-hop-dong">Chủ hợp đồng</option>
                                    <option value="vo-chong">Vợ/Chồng</option>
                                    <option value="con">Con</option>
                                    <option value="cha-me">Cha/Mẹ</option>
                                    <option value="anh-chi-em">Anh/Chị/Em</option>
                                    <option value="ban-be">Bạn bè</option>
                                    <option value="dong-nghiep">Đồng nghiệp</option>
                                    <option value="nguoi-than">Người thân</option>
                                    <option value="khac">Khác</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Ghi chú mối quan hệ</label>
                                <input type="text" class="form-control nha-tro-host-input" id="newCustomer-relationship-note" placeholder="Ghi chú thêm về mối quan hệ...">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Tỉnh/Thành phố</label>
                                <select class="form-select nha-tro-host-input" id="newCustomer-province">
                                    <option value="">Chọn Tỉnh/Thành phố</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Quận/Huyện</label>
                                <select class="form-select nha-tro-host-input" id="newCustomer-district">
                                    <option value="">Chọn Quận/Huyện</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Phường/Xã</label>
                                <select class="form-select nha-tro-host-input" id="newCustomer-ward">
                                    <option value="">Chọn Phường/Xã</option>
                                </select>
                            </div>
                            <div class="col-md-12">
                                <label class="form-label">Tên đường/Số nhà</label>
                                <input type="text" class="form-control nha-tro-host-input" id="newCustomer-street">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Ảnh CCCD mặt trước</label>
                                <div class="nha-tro-image-upload" onclick="document.getElementById('newCustomer-cccd-front').click()">
                                    <input type="file" id="newCustomer-cccd-front" accept="image/*" style="display: none;">
                                    <div id="newCustomer-cccd-front-preview" class="nha-tro-image-preview">
                                        <i class="fa fa-camera fa-2x"></i>
                                        <div class="mt-2">Tải ảnh mặt trước</div>
                                        <small class="text-muted">Nhấn để chọn ảnh</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Ảnh CCCD mặt sau</label>
                                <div class="nha-tro-image-upload" onclick="document.getElementById('newCustomer-cccd-back').click()">
                                    <input type="file" id="newCustomer-cccd-back" accept="image/*" style="display: none;">
                                    <div id="newCustomer-cccd-back-preview" class="nha-tro-image-preview">
                                        <i class="fa fa-camera fa-2x"></i>
                                        <div class="mt-2">Tải ảnh mặt sau</div>
                                        <small class="text-muted">Nhấn để chọn ảnh</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label">Ghi chú (tùy chọn)</label>
                                <textarea class="form-control nha-tro-host-input" id="newCustomer-notes" rows="3" placeholder="Ghi chú thêm về khách thuê..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer nha-tro-host-modal-footer">
                    <button type="button" class="btn btn-secondary nha-tro-host-btn-cancel" data-bs-dismiss="modal">
                        <i class="fa fa-times me-1"></i>Hủy
                    </button>
                    <button type="button" class="btn btn-success nha-tro-host-btn-save" id="saveCustomer-host">
                        <i class="fa fa-check me-1"></i>Lưu thông tin
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script th:src="@{/bootstrap/js/bootstrap.bundle.min.js}"></script>
    <script th:src="@{/js/contract.js}"></script>
    
    <script>
        // Housing area and room selection functionality
        document.addEventListener('DOMContentLoaded', function() {
            const housingAreaSelect = document.getElementById('housing-area');
            const roomSelectionSelect = document.getElementById('room-selection');
            
            // Sample room data for each housing area
            const roomData = {
        'khu-a': [
            { value: 'a101', text: 'Phòng A101 - 25m² - 3.5tr/tháng', number: 'A101', area: 25, price: 3500000 },
            { value: 'a102', text: 'Phòng A102 - 30m² - 4tr/tháng', number: 'A102', area: 30, price: 4000000 },
            { value: 'a103', text: 'Phòng A103 - 28m² - 3.8tr/tháng', number: 'A103', area: 28, price: 3800000 },
            { value: 'a201', text: 'Phòng A201 - 25m² - 3.5tr/tháng', number: 'A201', area: 25, price: 3500000 },
            { value: 'a202', text: 'Phòng A202 - 30m² - 4tr/tháng', number: 'A202', area: 30, price: 4000000 }
        ],
        'khu-b': [
            { value: 'b101', text: 'Phòng B101 - 22m² - 3.2tr/tháng', number: 'B101', area: 22, price: 3200000 },
            { value: 'b102', text: 'Phòng B102 - 27m² - 3.7tr/tháng', number: 'B102', area: 27, price: 3700000 },
            { value: 'b103', text: 'Phòng B103 - 25m² - 3.5tr/tháng', number: 'B103', area: 25, price: 3500000 },
            { value: 'b201', text: 'Phòng B201 - 22m² - 3.2tr/tháng', number: 'B201', area: 22, price: 3200000 },
            { value: 'b202', text: 'Phòng B202 - 27m² - 3.7tr/tháng', number: 'B202', area: 27, price: 3700000 }
        ],
        'khu-c': [
            { value: 'c101', text: 'Phòng C101 - 35m² - 4.5tr/tháng', number: 'C101', area: 35, price: 4500000 },
            { value: 'c102', text: 'Phòng C102 - 32m² - 4.2tr/tháng', number: 'C102', area: 32, price: 4200000 },
            { value: 'c103', text: 'Phòng C103 - 30m² - 4tr/tháng', number: 'C103', area: 30, price: 4000000 },
            { value: 'c201', text: 'Phòng C201 - 35m² - 4.5tr/tháng', number: 'C201', area: 35, price: 4500000 }
        ],
        'khu-d': [
            { value: 'd101', text: 'Phòng D101 - 20m² - 2.8tr/tháng', number: 'D101', area: 20, price: 2800000 },
            { value: 'd102', text: 'Phòng D102 - 24m² - 3.2tr/tháng', number: 'D102', area: 24, price: 3200000 },
            { value: 'd103', text: 'Phòng D103 - 26m² - 3.4tr/tháng', number: 'D103', area: 26, price: 3400000 },
            { value: 'd201', text: 'Phòng D201 - 20m² - 2.8tr/tháng', number: 'D201', area: 20, price: 2800000 },
            { value: 'd202', text: 'Phòng D202 - 24m² - 3.2tr/tháng', number: 'D202', area: 24, price: 3200000 }
        ]
    };
    
    // Handle housing area selection change
    housingAreaSelect.addEventListener('change', function() {
        const selectedArea = this.value;
        
        // Clear room selection
        roomSelectionSelect.innerHTML = '<option value="">-- Chọn phòng trọ --</option>';
        
        if (selectedArea && roomData[selectedArea]) {
            // Enable room selection
            roomSelectionSelect.disabled = false;
            
            // Populate room options
            roomData[selectedArea].forEach(room => {
                const option = document.createElement('option');
                option.value = room.value;
                option.textContent = room.text;
                roomSelectionSelect.appendChild(option);
            });
        } else {
            // Disable room selection if no area selected
            roomSelectionSelect.disabled = true;
            // Clear form fields
            document.getElementById('room-number').value = '';
            document.getElementById('room-area').value = '';
            document.getElementById('rent-price').value = '';
            
            // Update preview
            if (window.NhaTroContract) {
                window.NhaTroContract.updatePreviewField('room-number', 'preview-room-number');
                window.NhaTroContract.updatePreviewField('room-area', 'preview-room-area');
                window.NhaTroContract.updatePreviewField('rent-price', 'preview-rent');
            }
        }
    });
    
    // Handle room selection change
    roomSelectionSelect.addEventListener('change', function() {
        const selectedArea = housingAreaSelect.value;
        const selectedRoomValue = this.value;
        
        if (selectedArea && selectedRoomValue && roomData[selectedArea]) {
            // Find the selected room data
            const selectedRoom = roomData[selectedArea].find(room => room.value === selectedRoomValue);
            
            if (selectedRoom) {
                // Auto-fill room information
                document.getElementById('room-number').value = selectedRoom.number;
                document.getElementById('room-area').value = selectedRoom.area;
                document.getElementById('rent-price').value = selectedRoom.price;
                
                // Update contract preview using the existing NhaTroContract methods
                if (window.NhaTroContract) {
                    // Update preview fields with highlight effect
                    window.NhaTroContract.updatePreviewField('room-number', 'preview-room-number');
                    window.NhaTroContract.updatePreviewField('room-area', 'preview-room-area');
                    window.NhaTroContract.updatePreviewField('rent-price', 'preview-rent');
                    
                    // Recalculate deposit based on new rent price
                    window.NhaTroContract.calculateDeposit();
                    
                    // Show notification
                    window.NhaTroContract.showNotification(
                        `Đã chọn ${selectedRoom.number} - Diện tích: ${selectedRoom.area}m² - Giá: ${new Intl.NumberFormat('vi-VN').format(selectedRoom.price)} VNĐ/tháng`, 
                        'success'
                    );
                }
            }
        } else {
            // Clear fields if no room selected
            document.getElementById('room-number').value = '';
            document.getElementById('room-area').value = '';
            document.getElementById('rent-price').value = '';
            
            // Update preview
            if (window.NhaTroContract) {
                window.NhaTroContract.updatePreviewField('room-number', 'preview-room-number');
                window.NhaTroContract.updatePreviewField('room-area', 'preview-room-area');
                window.NhaTroContract.updatePreviewField('rent-price', 'preview-rent');
                window.NhaTroContract.calculateDeposit();
            }
        }
    });
});
    </script>

</body>

</html>